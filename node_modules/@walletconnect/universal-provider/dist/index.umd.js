(function(Ht,ze){typeof exports=="object"&&typeof module<"u"?ze(exports):typeof define=="function"&&define.amd?define(["exports"],ze):(Ht=typeof globalThis<"u"?globalThis:Ht||self,ze(Ht["@walletconnect/universal-provider"]={}))})(this,function(Ht){"use strict";var ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function qt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}function _c(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var bc=vc;function vc(t,e,r){var i=r&&r.stringify||_c,n=1;if(typeof t=="object"&&t!==null){var s=e.length+n;if(s===1)return t;var o=new Array(s);o[0]=i(t);for(var c=1;c<s;c++)o[c]=i(e[c]);return o.join(" ")}if(typeof t!="string")return t;var l=e.length;if(l===0)return t;for(var h="",f=1-n,_=-1,w=t&&t.length||0,S=0;S<w;){if(t.charCodeAt(S)===37&&S+1<w){switch(_=_>-1?_:0,t.charCodeAt(S+1)){case 100:case 102:if(f>=l||e[f]==null)break;_<S&&(h+=t.slice(_,S)),h+=Number(e[f]),_=S+2,S++;break;case 105:if(f>=l||e[f]==null)break;_<S&&(h+=t.slice(_,S)),h+=Math.floor(Number(e[f])),_=S+2,S++;break;case 79:case 111:case 106:if(f>=l||e[f]===void 0)break;_<S&&(h+=t.slice(_,S));var m=typeof e[f];if(m==="string"){h+="'"+e[f]+"'",_=S+2,S++;break}if(m==="function"){h+=e[f].name||"<anonymous>",_=S+2,S++;break}h+=i(e[f]),_=S+2,S++;break;case 115:if(f>=l)break;_<S&&(h+=t.slice(_,S)),h+=String(e[f]),_=S+2,S++;break;case 37:_<S&&(h+=t.slice(_,S)),h+="%",_=S+2,S++,f--;break}++f}++S}return _===-1?t:(_<w&&(h+=t.slice(_)),h)}const kn=bc;var fr=Dt;const dr=Ac().console||{},wc={mapHttpRequest:Wr,mapHttpResponse:Wr,wrapRequestSerializer:Ti,wrapResponseSerializer:Ti,wrapErrorSerializer:Ti,req:Wr,res:Wr,err:xc};function mc(t,e){return Array.isArray(t)?t.filter(function(i){return i!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Dt(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||dr;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},n=mc(t.browser.serialize,i);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const c=t.level||"info",l=Object.create(r);l.log||(l.log=pr),Object.defineProperty(l,"levelVal",{get:f}),Object.defineProperty(l,"level",{get:_,set:w});const h={transmit:e,serialize:n,asObject:t.browser.asObject,levels:o,timestamp:Oc(t)};l.levels=Dt.levels,l.level=c,l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=pr,l.serializers=i,l._serialize=n,l._stdErrSerialize=s,l.child=S,e&&(l._logEvent=Ai());function f(){return this.level==="silent"?1/0:this.levels.values[this.level]}function _(){return this._level}function w(m){if(m!=="silent"&&!this.levels.values[m])throw Error("unknown level "+m);this._level=m,rr(h,l,"error","log"),rr(h,l,"fatal","error"),rr(h,l,"warn","error"),rr(h,l,"info","log"),rr(h,l,"debug","log"),rr(h,l,"trace","log")}function S(m,R){if(!m)throw new Error("missing bindings for child Pino");R=R||{},n&&m.serializers&&(R.serializers=m.serializers);const L=R.serializers;if(n&&L){var H=Object.assign({},i,L),x=t.browser.serialize===!0?Object.keys(H):n;delete m.serializers,kr([m],x,H,this._stdErrSerialize)}function P(y){this._childLevel=(y._childLevel|0)+1,this.error=ir(y,m,"error"),this.fatal=ir(y,m,"fatal"),this.warn=ir(y,m,"warn"),this.info=ir(y,m,"info"),this.debug=ir(y,m,"debug"),this.trace=ir(y,m,"trace"),H&&(this.serializers=H,this._serialize=x),e&&(this._logEvent=Ai([].concat(y._logEvent.bindings,m)))}return P.prototype=this,new P(this)}return l}Dt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Dt.stdSerializers=wc,Dt.stdTimeFunctions=Object.assign({},{nullTime:Wn,epochTime:Yn,unixTime:Ic,isoTime:Pc});function rr(t,e,r,i){const n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?pr:n[r]?n[r]:dr[r]||dr[i]||pr,Ec(t,e,r)}function Ec(t,e,r){!t.transmit&&e[r]===pr||(e[r]=function(i){return function(){const s=t.timestamp(),o=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===dr?dr:this;for(var l=0;l<o.length;l++)o[l]=arguments[l];if(t.serialize&&!t.asObject&&kr(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(c,Dc(this,r,o,s)):i.apply(c,o),t.transmit){const h=t.transmit.level||e.level,f=Dt.levels.values[h],_=Dt.levels.values[r];if(_<f)return;Sc(this,{ts:s,methodLevel:r,methodValue:_,transmitLevel:h,transmitValue:Dt.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[r]))}function Dc(t,e,r,i){t._serialize&&kr(r,t._serialize,t.serializers,t._stdErrSerialize);const n=r.slice();let s=n[0];const o={};i&&(o.time=i),o.level=Dt.levels.values[e];let c=(t._childLevel|0)+1;if(c<1&&(c=1),s!==null&&typeof s=="object"){for(;c--&&typeof n[0]=="object";)Object.assign(o,n.shift());s=n.length?kn(n.shift(),n):void 0}else typeof s=="string"&&(s=kn(n.shift(),n));return s!==void 0&&(o.msg=s),o}function kr(t,e,r,i){for(const n in t)if(i&&t[n]instanceof Error)t[n]=Dt.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(const s in t[n])e&&e.indexOf(s)>-1&&s in r&&(t[n][s]=r[s](t[n][s]))}function ir(t,e,r){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function Sc(t,e,r){const i=e.send,n=e.ts,s=e.methodLevel,o=e.methodValue,c=e.val,l=t._logEvent.bindings;kr(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(h){return l.indexOf(h)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=o,i(s,t._logEvent,c),t._logEvent=Ai(l)}function Ai(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function xc(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function Oc(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?Wn:Yn}function Wr(){return{}}function Ti(t){return t}function pr(){}function Wn(){return!1}function Yn(){return Date.now()}function Ic(){return Math.round(Date.now()/1e3)}function Pc(){return new Date(Date.now()).toISOString()}function Ac(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var it={exports:{}},nr=typeof Reflect=="object"?Reflect:null,Jn=nr&&typeof nr.apply=="function"?nr.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},Yr;nr&&typeof nr.ownKeys=="function"?Yr=nr.ownKeys:Object.getOwnPropertySymbols?Yr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Yr=function(e){return Object.getOwnPropertyNames(e)};function Tc(t){console&&console.warn&&console.warn(t)}var Xn=Number.isNaN||function(e){return e!==e};function xe(){xe.init.call(this)}it.exports=xe,it.exports.once=Lc,xe.EventEmitter=xe,xe.prototype._events=void 0,xe.prototype._eventsCount=0,xe.prototype._maxListeners=void 0;var Zn=10;function Jr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(xe,"defaultMaxListeners",{enumerable:!0,get:function(){return Zn},set:function(t){if(typeof t!="number"||t<0||Xn(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Zn=t}}),xe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},xe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Xn(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Qn(t){return t._maxListeners===void 0?xe.defaultMaxListeners:t._maxListeners}xe.prototype.getMaxListeners=function(){return Qn(this)},xe.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")Jn(l,this,r);else for(var h=l.length,f=ns(l,h),i=0;i<h;++i)Jn(f[i],this,r);return!0};function es(t,e,r,i){var n,s,o;if(Jr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=Qn(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=o.length,Tc(c)}return t}xe.prototype.addListener=function(e,r){return es(this,e,r,!1)},xe.prototype.on=xe.prototype.addListener,xe.prototype.prependListener=function(e,r){return es(this,e,r,!0)};function Cc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ts(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=Cc.bind(i);return n.listener=r,i.wrapFn=n,n}xe.prototype.once=function(e,r){return Jr(r),this.on(e,ts(this,e,r)),this},xe.prototype.prependOnceListener=function(e,r){return Jr(r),this.prependListener(e,ts(this,e,r)),this},xe.prototype.removeListener=function(e,r){var i,n,s,o,c;if(Jr(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===r||i[o].listener===r){c=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():Nc(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,c||r)}return this},xe.prototype.off=xe.prototype.removeListener,xe.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function rs(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?Rc(n):ns(n,n.length)}xe.prototype.listeners=function(e){return rs(this,e,!0)},xe.prototype.rawListeners=function(e){return rs(this,e,!1)},xe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):is.call(t,e)},xe.prototype.listenerCount=is;function is(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}xe.prototype.eventNames=function(){return this._eventsCount>0?Yr(this._events):[]};function ns(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function Nc(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Rc(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Lc(t,e){return new Promise(function(r,i){function n(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}ss(t,e,s,{once:!0}),e!=="error"&&Fc(t,n,{once:!0})})}function Fc(t,e,r){typeof t.on=="function"&&ss(t,"error",e,r)}function ss(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Xr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ci=function(t,e){return Ci=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Ci(t,e)};function $c(t,e){Ci(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ni=function(){return Ni=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ni.apply(this,arguments)};function Uc(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Mc(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function jc(t,e){return function(r,i){e(r,i,t)}}function Bc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Hc(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(f){try{h(i.next(f))}catch(_){o(_)}}function l(f){try{h(i.throw(f))}catch(_){o(_)}}function h(f){f.done?s(f.value):n(f.value).then(c,l)}h((i=i.apply(t,e||[])).next())})}function qc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(f){return l([h,f])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function zc(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Kc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Ri(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function os(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Vc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(os(arguments[e]));return t}function Gc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,c=s.length;o<c;o++,n++)i[n]=s[o];return i}function gr(t){return this instanceof gr?(this.v=t,this):new gr(t)}function kc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(w){i[w]&&(n[w]=function(S){return new Promise(function(m,R){s.push([w,S,m,R])>1||c(w,S)})})}function c(w,S){try{l(i[w](S))}catch(m){_(s[0][3],m)}}function l(w){w.value instanceof gr?Promise.resolve(w.value.v).then(h,f):_(s[0][2],w)}function h(w){c("next",w)}function f(w){c("throw",w)}function _(w,S){w(S),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Wc(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:gr(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function Yc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ri=="function"?Ri(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(c,l){o=t[s](o),n(c,l,o.done,o.value)})}}function n(s,o,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},o)}}function Jc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Xc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Zc(t){return t&&t.__esModule?t:{default:t}}function Qc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function eu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var tu=Object.freeze({__proto__:null,__extends:$c,get __assign(){return Ni},__rest:Uc,__decorate:Mc,__param:jc,__metadata:Bc,__awaiter:Hc,__generator:qc,__createBinding:zc,__exportStar:Kc,__values:Ri,__read:os,__spread:Vc,__spreadArrays:Gc,__await:gr,__asyncGenerator:kc,__asyncDelegator:Wc,__asyncValues:Yc,__makeTemplateObject:Jc,__importStar:Xc,__importDefault:Zc,__classPrivateFieldGet:Qc,__classPrivateFieldSet:eu}),as=qt(tu),yr={};Object.defineProperty(yr,"__esModule",{value:!0});function ru(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}yr.safeJsonParse=ru;function iu(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}yr.safeJsonStringify=iu;var _r={exports:{}},cs;function nu(){return cs||(cs=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ze<"u"&&ze.localStorage?_r.exports=ze.localStorage:typeof window<"u"&&window.localStorage?_r.exports=window.localStorage:_r.exports=new e}()),_r.exports}var Li={},br={},us;function su(){if(us)return br;us=1,Object.defineProperty(br,"__esModule",{value:!0}),br.IKeyValueStorage=void 0;class t{}return br.IKeyValueStorage=t,br}var vr={},hs;function ou(){if(hs)return vr;hs=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.parseEntry=void 0;const t=yr;function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return vr.parseEntry=e,vr}var ls;function au(){return ls||(ls=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=as;e.__exportStar(su(),t),e.__exportStar(ou(),t)}(Li)),Li}Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.KeyValueStorage=void 0;const sr=as,fs=yr,cu=sr.__importDefault(nu()),uu=au();class ds{constructor(){this.localStorage=cu.default}getKeys(){return sr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return sr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(uu.parseEntry)})}getItem(e){return sr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return fs.safeJsonParse(r)})}setItem(e,r){return sr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,fs.safeJsonStringify(r))})}removeItem(e){return sr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Xr.KeyValueStorage=ds;var hu=Xr.default=ds,wr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Fi=function(t,e){return Fi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Fi(t,e)};function lu(t,e){Fi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var $i=function(){return $i=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},$i.apply(this,arguments)};function fu(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function du(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function pu(t,e){return function(r,i){e(r,i,t)}}function gu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function yu(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(f){try{h(i.next(f))}catch(_){o(_)}}function l(f){try{h(i.throw(f))}catch(_){o(_)}}function h(f){f.done?s(f.value):n(f.value).then(c,l)}h((i=i.apply(t,e||[])).next())})}function _u(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(f){return l([h,f])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function bu(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function vu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Ui(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ps(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function wu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ps(arguments[e]));return t}function mu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,c=s.length;o<c;o++,n++)i[n]=s[o];return i}function mr(t){return this instanceof mr?(this.v=t,this):new mr(t)}function Eu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(w){i[w]&&(n[w]=function(S){return new Promise(function(m,R){s.push([w,S,m,R])>1||c(w,S)})})}function c(w,S){try{l(i[w](S))}catch(m){_(s[0][3],m)}}function l(w){w.value instanceof mr?Promise.resolve(w.value.v).then(h,f):_(s[0][2],w)}function h(w){c("next",w)}function f(w){c("throw",w)}function _(w,S){w(S),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Du(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:mr(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function Su(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ui=="function"?Ui(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(c,l){o=t[s](o),n(c,l,o.done,o.value)})}}function n(s,o,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},o)}}function xu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Ou(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Iu(t){return t&&t.__esModule?t:{default:t}}function Pu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Au(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Tu=Object.freeze({__proto__:null,__extends:lu,get __assign(){return $i},__rest:fu,__decorate:du,__param:pu,__metadata:gu,__awaiter:yu,__generator:_u,__createBinding:bu,__exportStar:vu,__values:Ui,__read:ps,__spread:wu,__spreadArrays:mu,__await:mr,__asyncGenerator:Eu,__asyncDelegator:Du,__asyncValues:Su,__makeTemplateObject:xu,__importStar:Ou,__importDefault:Iu,__classPrivateFieldGet:Pu,__classPrivateFieldSet:Au}),Zr=qt(Tu),Er={},Z={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Mi=function(t,e){return Mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Mi(t,e)};function Cu(t,e){Mi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ji=function(){return ji=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ji.apply(this,arguments)};function Nu(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Ru(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Lu(t,e){return function(r,i){e(r,i,t)}}function Fu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function $u(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(f){try{h(i.next(f))}catch(_){o(_)}}function l(f){try{h(i.throw(f))}catch(_){o(_)}}function h(f){f.done?s(f.value):n(f.value).then(c,l)}h((i=i.apply(t,e||[])).next())})}function Uu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(f){return l([h,f])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Mu(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function ju(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Bi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function gs(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Bu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(gs(arguments[e]));return t}function Hu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,c=s.length;o<c;o++,n++)i[n]=s[o];return i}function Dr(t){return this instanceof Dr?(this.v=t,this):new Dr(t)}function qu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(w){i[w]&&(n[w]=function(S){return new Promise(function(m,R){s.push([w,S,m,R])>1||c(w,S)})})}function c(w,S){try{l(i[w](S))}catch(m){_(s[0][3],m)}}function l(w){w.value instanceof Dr?Promise.resolve(w.value.v).then(h,f):_(s[0][2],w)}function h(w){c("next",w)}function f(w){c("throw",w)}function _(w,S){w(S),s.shift(),s.length&&c(s[0][0],s[0][1])}}function zu(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:Dr(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function Ku(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Bi=="function"?Bi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(c,l){o=t[s](o),n(c,l,o.done,o.value)})}}function n(s,o,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},o)}}function Vu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Gu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function ku(t){return t&&t.__esModule?t:{default:t}}function Wu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Yu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Ju=Object.freeze({__proto__:null,__extends:Cu,get __assign(){return ji},__rest:Nu,__decorate:Ru,__param:Lu,__metadata:Fu,__awaiter:$u,__generator:Uu,__createBinding:Mu,__exportStar:ju,__values:Bi,__read:gs,__spread:Bu,__spreadArrays:Hu,__await:Dr,__asyncGenerator:qu,__asyncDelegator:zu,__asyncValues:Ku,__makeTemplateObject:Vu,__importStar:Gu,__importDefault:ku,__classPrivateFieldGet:Wu,__classPrivateFieldSet:Yu}),Qr=qt(Ju),Hi={},Sr={},ys;function Xu(){if(ys)return Sr;ys=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Sr.delay=t,Sr}var zt={},qi={},Kt={},_s;function Zu(){return _s||(_s=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.ONE_THOUSAND=Kt.ONE_HUNDRED=void 0,Kt.ONE_HUNDRED=100,Kt.ONE_THOUSAND=1e3),Kt}var zi={},bs;function Qu(){return bs||(bs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(zi)),zi}var vs;function ws(){return vs||(vs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Qr;e.__exportStar(Zu(),t),e.__exportStar(Qu(),t)}(qi)),qi}var ms;function eh(){if(ms)return zt;ms=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.fromMiliseconds=zt.toMiliseconds=void 0;const t=ws();function e(i){return i*t.ONE_THOUSAND}zt.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return zt.fromMiliseconds=r,zt}var Es;function th(){return Es||(Es=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Qr;e.__exportStar(Xu(),t),e.__exportStar(eh(),t)}(Hi)),Hi}var or={},Ds;function rh(){if(Ds)return or;Ds=1,Object.defineProperty(or,"__esModule",{value:!0}),or.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return or.Watch=t,or.default=t,or}var Ki={},xr={},Ss;function ih(){if(Ss)return xr;Ss=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.IWatch=void 0;class t{}return xr.IWatch=t,xr}var xs;function nh(){return xs||(xs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Qr.__exportStar(ih(),t)}(Ki)),Ki}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Qr;e.__exportStar(th(),t),e.__exportStar(rh(),t),e.__exportStar(nh(),t),e.__exportStar(ws(),t)})(Z);var Vi={},Or={};class Vt{}var sh=Object.freeze({__proto__:null,IEvents:Vt}),oh=qt(sh),Os;function ah(){if(Os)return Or;Os=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.IHeartBeat=void 0;const t=oh;class e extends t.IEvents{constructor(i){super()}}return Or.IHeartBeat=e,Or}var Is;function Ps(){return Is||(Is=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Zr.__exportStar(ah(),t)}(Vi)),Vi}var Gi={},Gt={},As;function ch(){if(As)return Gt;As=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.HEARTBEAT_EVENTS=Gt.HEARTBEAT_INTERVAL=void 0;const t=Z;return Gt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Gt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Gt}var Ts;function Cs(){return Ts||(Ts=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Zr.__exportStar(ch(),t)}(Gi)),Gi}var Ns;function uh(){if(Ns)return Er;Ns=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.HeartBeat=void 0;const t=Zr,e=it.exports,r=Z,i=Ps(),n=Cs();class s extends i.IHeartBeat{constructor(c){super(c),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=c?.interval||n.HEARTBEAT_INTERVAL}static init(c){return t.__awaiter(this,void 0,void 0,function*(){const l=new s(c);return yield l.init(),l})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(c,l){this.events.on(c,l)}once(c,l){this.events.once(c,l)}off(c,l){this.events.off(c,l)}removeListener(c,l){this.events.removeListener(c,l)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return Er.HeartBeat=s,Er}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Zr;e.__exportStar(uh(),t),e.__exportStar(Ps(),t),e.__exportStar(Cs(),t)})(wr);var Se={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ki=function(t,e){return ki=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},ki(t,e)};function hh(t,e){ki(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Wi=function(){return Wi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Wi.apply(this,arguments)};function lh(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function fh(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function dh(t,e){return function(r,i){e(r,i,t)}}function ph(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function gh(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(f){try{h(i.next(f))}catch(_){o(_)}}function l(f){try{h(i.throw(f))}catch(_){o(_)}}function h(f){f.done?s(f.value):n(f.value).then(c,l)}h((i=i.apply(t,e||[])).next())})}function yh(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(f){return l([h,f])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function _h(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function bh(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Yi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rs(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function vh(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Rs(arguments[e]));return t}function wh(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,c=s.length;o<c;o++,n++)i[n]=s[o];return i}function Ir(t){return this instanceof Ir?(this.v=t,this):new Ir(t)}function mh(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(w){i[w]&&(n[w]=function(S){return new Promise(function(m,R){s.push([w,S,m,R])>1||c(w,S)})})}function c(w,S){try{l(i[w](S))}catch(m){_(s[0][3],m)}}function l(w){w.value instanceof Ir?Promise.resolve(w.value.v).then(h,f):_(s[0][2],w)}function h(w){c("next",w)}function f(w){c("throw",w)}function _(w,S){w(S),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Eh(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:Ir(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function Dh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Yi=="function"?Yi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(c,l){o=t[s](o),n(c,l,o.done,o.value)})}}function n(s,o,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},o)}}function Sh(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function xh(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Oh(t){return t&&t.__esModule?t:{default:t}}function Ih(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Ph(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Ah=Object.freeze({__proto__:null,__extends:hh,get __assign(){return Wi},__rest:lh,__decorate:fh,__param:dh,__metadata:ph,__awaiter:gh,__generator:yh,__createBinding:_h,__exportStar:bh,__values:Yi,__read:Rs,__spread:vh,__spreadArrays:wh,__await:Ir,__asyncGenerator:mh,__asyncDelegator:Eh,__asyncValues:Dh,__makeTemplateObject:Sh,__importStar:xh,__importDefault:Oh,__classPrivateFieldGet:Ih,__classPrivateFieldSet:Ph}),Th=qt(Ah),kt={},Ls;function Fs(){return Ls||(Ls=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.PINO_CUSTOM_CONTEXT_KEY=kt.PINO_LOGGER_DEFAULTS=void 0,kt.PINO_LOGGER_DEFAULTS={level:"info"},kt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),kt}var ot={},$s;function Ch(){if($s)return ot;$s=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const t=Fs();function e(c){return Object.assign(Object.assign({},c),{level:c?.level||t.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=e;function r(c,l=t.PINO_CUSTOM_CONTEXT_KEY){return c[l]||""}ot.getBrowserLoggerContext=r;function i(c,l,h=t.PINO_CUSTOM_CONTEXT_KEY){return c[h]=l,c}ot.setBrowserLoggerContext=i;function n(c,l=t.PINO_CUSTOM_CONTEXT_KEY){let h="";return typeof c.bindings>"u"?h=r(c,l):h=c.bindings().context||"",h}ot.getLoggerContext=n;function s(c,l,h=t.PINO_CUSTOM_CONTEXT_KEY){const f=n(c,h);return f.trim()?`${f}/${l}`:l}ot.formatChildLoggerContext=s;function o(c,l,h=t.PINO_CUSTOM_CONTEXT_KEY){const f=s(c,l,h),_=c.child({context:f});return i(_,f,h)}return ot.generateChildLogger=o,ot}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Th,r=e.__importDefault(fr);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Fs(),t),e.__exportStar(Ch(),t)})(Se);class Nh extends Vt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Rh extends Vt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Lh{constructor(e,r){this.logger=e,this.core=r}}class Fh extends Vt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class $h extends Vt{constructor(e){super()}}class Uh{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class Mh extends Vt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class jh extends Vt{constructor(e,r){super(),this.core=e,this.logger=r}}class Bh{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class Hh{constructor(e){this.client=e}}function Ji(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function Pr(t){return typeof t=="string"?t:JSON.stringify(t)}var Xi={},ar={},ei={},ti={};Object.defineProperty(ti,"__esModule",{value:!0}),ti.BrowserRandomSource=void 0;const Us=65536;class qh{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=Us)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,Us)));return r}}ti.BrowserRandomSource=qh;function zh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ri={},dt={};Object.defineProperty(dt,"__esModule",{value:!0});function Kh(t){for(var e=0;e<t.length;e++)t[e]=0;return t}dt.wipe=Kh;var Vh={},Gh=Object.freeze({__proto__:null,default:Vh}),kh=qt(Gh);Object.defineProperty(ri,"__esModule",{value:!0}),ri.NodeRandomSource=void 0;const Wh=dt;class Yh{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof zh<"u"){const e=kh;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,Wh.wipe)(r),i}}ri.NodeRandomSource=Yh,Object.defineProperty(ei,"__esModule",{value:!0}),ei.SystemRandomSource=void 0;const Jh=ti,Xh=ri;class Zh{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Jh.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Xh.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ei.SystemRandomSource=Zh;var re={},Ms={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,l){var h=c>>>16&65535,f=c&65535,_=l>>>16&65535,w=l&65535;return f*w+(h*w+f*_<<16>>>0)|0}t.mul=Math.imul||e;function r(c,l){return c+l|0}t.add=r;function i(c,l){return c-l|0}t.sub=i;function n(c,l){return c<<l|c>>>32-l}t.rotl=n;function s(c,l){return c<<32-l|c>>>l}t.rotr=s;function o(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}t.isInteger=Number.isInteger||o,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(c){return t.isInteger(c)&&c>=-t.MAX_SAFE_INTEGER&&c<=t.MAX_SAFE_INTEGER}})(Ms),Object.defineProperty(re,"__esModule",{value:!0});var js=Ms;function Qh(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}re.readInt16BE=Qh;function el(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}re.readUint16BE=el;function tl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}re.readInt16LE=tl;function rl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}re.readUint16LE=rl;function Bs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}re.writeUint16BE=Bs,re.writeInt16BE=Bs;function Hs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}re.writeUint16LE=Hs,re.writeInt16LE=Hs;function Zi(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}re.readInt32BE=Zi;function Qi(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}re.readUint32BE=Qi;function en(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}re.readInt32LE=en;function tn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}re.readUint32LE=tn;function ii(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}re.writeUint32BE=ii,re.writeInt32BE=ii;function ni(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}re.writeUint32LE=ni,re.writeInt32LE=ni;function il(t,e){e===void 0&&(e=0);var r=Zi(t,e),i=Zi(t,e+4);return r*4294967296+i-(i>>31)*4294967296}re.readInt64BE=il;function nl(t,e){e===void 0&&(e=0);var r=Qi(t,e),i=Qi(t,e+4);return r*4294967296+i}re.readUint64BE=nl;function sl(t,e){e===void 0&&(e=0);var r=en(t,e),i=en(t,e+4);return i*4294967296+r-(r>>31)*4294967296}re.readInt64LE=sl;function ol(t,e){e===void 0&&(e=0);var r=tn(t,e),i=tn(t,e+4);return i*4294967296+r}re.readUint64LE=ol;function qs(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),ii(t/4294967296>>>0,e,r),ii(t>>>0,e,r+4),e}re.writeUint64BE=qs,re.writeInt64BE=qs;function zs(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),ni(t>>>0,e,r),ni(t/4294967296>>>0,e,r+4),e}re.writeUint64LE=zs,re.writeInt64LE=zs;function al(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}re.readUintBE=al;function cl(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}re.readUintLE=cl;function ul(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!js.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}re.writeUintBE=ul;function hl(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!js.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}re.writeUintLE=hl;function ll(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}re.readFloat32BE=ll;function fl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}re.readFloat32LE=fl;function dl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}re.readFloat64BE=dl;function pl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}re.readFloat64LE=pl;function gl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}re.writeFloat32BE=gl;function yl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}re.writeFloat32LE=yl;function _l(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}re.writeFloat64BE=_l;function bl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}re.writeFloat64LE=bl,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=ei,r=re,i=dt;t.defaultRandomSource=new e.SystemRandomSource;function n(h,f=t.defaultRandomSource){return f.randomBytes(h)}t.randomBytes=n;function s(h=t.defaultRandomSource){const f=n(4,h),_=(0,r.readUint32LE)(f);return(0,i.wipe)(f),_}t.randomUint32=s;const o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(h,f=o,_=t.defaultRandomSource){if(f.length<2)throw new Error("randomString charset is too short");if(f.length>256)throw new Error("randomString charset is too long");let w="";const S=f.length,m=256-256%S;for(;h>0;){const R=n(Math.ceil(h*256/m),_);for(let L=0;L<R.length&&h>0;L++){const H=R[L];H<m&&(w+=f.charAt(H%S),h--)}(0,i.wipe)(R)}return w}t.randomString=c;function l(h,f=o,_=t.defaultRandomSource){const w=Math.ceil(h/(Math.log(f.length)/Math.LN2));return c(w,f,_)}t.randomStringForEntropy=l}(ar);var Ks={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=dt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(l,h){if(h===void 0&&(h=l.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var f=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&h>0;)this._buffer[this._bufferLength++]=l[f++],h--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(f=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,l,f,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=l[f++],h--;return this},c.prototype.finish=function(l){if(!this._finished){var h=this._bytesHashed,f=this._bufferLength,_=h/536870912|0,w=h<<3,S=h%128<112?128:256;this._buffer[f]=128;for(var m=f+1;m<S-8;m++)this._buffer[m]=0;e.writeUint32BE(_,this._buffer,S-8),e.writeUint32BE(w,this._buffer,S-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,S),this._finished=!0}for(var m=0;m<this.digestLength/8;m++)e.writeUint32BE(this._stateHi[m],l,m*8),e.writeUint32BE(this._stateLo[m],l,m*8+4);return this},c.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(l){return this._stateHi.set(l.stateHi),this._stateLo.set(l.stateLo),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(l){r.wipe(l.stateHi),r.wipe(l.stateLo),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},c}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,l,h,f,_,w,S){for(var m=h[0],R=h[1],L=h[2],H=h[3],x=h[4],P=h[5],y=h[6],D=h[7],E=f[0],a=f[1],d=f[2],M=f[3],q=f[4],G=f[5],J=f[6],X=f[7],g,b,$,U,N,C,j,B;S>=128;){for(var Q=0;Q<16;Q++){var z=8*Q+w;c[Q]=e.readUint32BE(_,z),l[Q]=e.readUint32BE(_,z+4)}for(var Q=0;Q<80;Q++){var ee=m,Y=R,ae=L,T=H,A=x,O=P,u=y,v=D,K=E,k=a,le=d,_e=M,de=q,we=G,Fe=J,Te=X;if(g=D,b=X,N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=(x>>>14|q<<32-14)^(x>>>18|q<<32-18)^(q>>>41-32|x<<32-(41-32)),b=(q>>>14|x<<32-14)^(q>>>18|x<<32-18)^(x>>>41-32|q<<32-(41-32)),N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,g=x&P^~x&y,b=q&G^~q&J,N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,g=n[Q*2],b=n[Q*2+1],N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,g=c[Q%16],b=l[Q%16],N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,$=j&65535|B<<16,U=N&65535|C<<16,g=$,b=U,N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=(m>>>28|E<<32-28)^(E>>>34-32|m<<32-(34-32))^(E>>>39-32|m<<32-(39-32)),b=(E>>>28|m<<32-28)^(m>>>34-32|E<<32-(34-32))^(m>>>39-32|E<<32-(39-32)),N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,g=m&R^m&L^R&L,b=E&a^E&d^a&d,N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,v=j&65535|B<<16,Te=N&65535|C<<16,g=T,b=_e,N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=$,b=U,N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,T=j&65535|B<<16,_e=N&65535|C<<16,R=ee,L=Y,H=ae,x=T,P=A,y=O,D=u,m=v,a=K,d=k,M=le,q=_e,G=de,J=we,X=Fe,E=Te,Q%16===15)for(var z=0;z<16;z++)g=c[z],b=l[z],N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=c[(z+9)%16],b=l[(z+9)%16],N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,$=c[(z+1)%16],U=l[(z+1)%16],g=($>>>1|U<<32-1)^($>>>8|U<<32-8)^$>>>7,b=(U>>>1|$<<32-1)^(U>>>8|$<<32-8)^(U>>>7|$<<32-7),N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,$=c[(z+14)%16],U=l[(z+14)%16],g=($>>>19|U<<32-19)^(U>>>61-32|$<<32-(61-32))^$>>>6,b=(U>>>19|$<<32-19)^($>>>61-32|U<<32-(61-32))^(U>>>6|$<<32-6),N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,c[z]=j&65535|B<<16,l[z]=N&65535|C<<16}g=m,b=E,N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=h[0],b=f[0],N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,h[0]=m=j&65535|B<<16,f[0]=E=N&65535|C<<16,g=R,b=a,N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=h[1],b=f[1],N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,h[1]=R=j&65535|B<<16,f[1]=a=N&65535|C<<16,g=L,b=d,N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=h[2],b=f[2],N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,h[2]=L=j&65535|B<<16,f[2]=d=N&65535|C<<16,g=H,b=M,N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=h[3],b=f[3],N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,h[3]=H=j&65535|B<<16,f[3]=M=N&65535|C<<16,g=x,b=q,N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=h[4],b=f[4],N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,h[4]=x=j&65535|B<<16,f[4]=q=N&65535|C<<16,g=P,b=G,N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=h[5],b=f[5],N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,h[5]=P=j&65535|B<<16,f[5]=G=N&65535|C<<16,g=y,b=J,N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=h[6],b=f[6],N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,h[6]=y=j&65535|B<<16,f[6]=J=N&65535|C<<16,g=D,b=X,N=b&65535,C=b>>>16,j=g&65535,B=g>>>16,g=h[7],b=f[7],N+=b&65535,C+=b>>>16,j+=g&65535,B+=g>>>16,C+=N>>>16,j+=C>>>16,B+=j>>>16,h[7]=D=j&65535|B<<16,f[7]=X=N&65535|C<<16,w+=128,S-=128}return w}function o(c){var l=new i;l.update(c);var h=l.digest();return l.clean(),h}t.hash=o})(Ks),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=ar,r=Ks,i=dt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(T){const A=new Float64Array(16);if(T)for(let O=0;O<T.length;O++)A[O]=T[O];return A}const s=new Uint8Array(32);s[0]=9;const o=n(),c=n([1]),l=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),_=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),w=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function S(T,A){for(let O=0;O<16;O++)T[O]=A[O]|0}function m(T){let A=1;for(let O=0;O<16;O++){let u=T[O]+A+65535;A=Math.floor(u/65536),T[O]=u-A*65536}T[0]+=A-1+37*(A-1)}function R(T,A,O){const u=~(O-1);for(let v=0;v<16;v++){const K=u&(T[v]^A[v]);T[v]^=K,A[v]^=K}}function L(T,A){const O=n(),u=n();for(let v=0;v<16;v++)u[v]=A[v];m(u),m(u),m(u);for(let v=0;v<2;v++){O[0]=u[0]-65517;for(let k=1;k<15;k++)O[k]=u[k]-65535-(O[k-1]>>16&1),O[k-1]&=65535;O[15]=u[15]-32767-(O[14]>>16&1);const K=O[15]>>16&1;O[14]&=65535,R(u,O,1-K)}for(let v=0;v<16;v++)T[2*v]=u[v]&255,T[2*v+1]=u[v]>>8}function H(T,A){let O=0;for(let u=0;u<32;u++)O|=T[u]^A[u];return(1&O-1>>>8)-1}function x(T,A){const O=new Uint8Array(32),u=new Uint8Array(32);return L(O,T),L(u,A),H(O,u)}function P(T){const A=new Uint8Array(32);return L(A,T),A[0]&1}function y(T,A){for(let O=0;O<16;O++)T[O]=A[2*O]+(A[2*O+1]<<8);T[15]&=32767}function D(T,A,O){for(let u=0;u<16;u++)T[u]=A[u]+O[u]}function E(T,A,O){for(let u=0;u<16;u++)T[u]=A[u]-O[u]}function a(T,A,O){let u,v,K=0,k=0,le=0,_e=0,de=0,we=0,Fe=0,Te=0,ye=0,pe=0,fe=0,ue=0,ce=0,oe=0,se=0,te=0,he=0,ge=0,ie=0,be=0,ve=0,Ee=0,De=0,me=0,mt=0,Pt=0,Ut=0,pt=0,Zt=0,Kr=0,Ei=0,Ue=O[0],Ce=O[1],Me=O[2],je=O[3],Be=O[4],Ne=O[5],Ge=O[6],ke=O[7],We=O[8],Ye=O[9],Je=O[10],qe=O[11],He=O[12],Pe=O[13],Xe=O[14],Ze=O[15];u=A[0],K+=u*Ue,k+=u*Ce,le+=u*Me,_e+=u*je,de+=u*Be,we+=u*Ne,Fe+=u*Ge,Te+=u*ke,ye+=u*We,pe+=u*Ye,fe+=u*Je,ue+=u*qe,ce+=u*He,oe+=u*Pe,se+=u*Xe,te+=u*Ze,u=A[1],k+=u*Ue,le+=u*Ce,_e+=u*Me,de+=u*je,we+=u*Be,Fe+=u*Ne,Te+=u*Ge,ye+=u*ke,pe+=u*We,fe+=u*Ye,ue+=u*Je,ce+=u*qe,oe+=u*He,se+=u*Pe,te+=u*Xe,he+=u*Ze,u=A[2],le+=u*Ue,_e+=u*Ce,de+=u*Me,we+=u*je,Fe+=u*Be,Te+=u*Ne,ye+=u*Ge,pe+=u*ke,fe+=u*We,ue+=u*Ye,ce+=u*Je,oe+=u*qe,se+=u*He,te+=u*Pe,he+=u*Xe,ge+=u*Ze,u=A[3],_e+=u*Ue,de+=u*Ce,we+=u*Me,Fe+=u*je,Te+=u*Be,ye+=u*Ne,pe+=u*Ge,fe+=u*ke,ue+=u*We,ce+=u*Ye,oe+=u*Je,se+=u*qe,te+=u*He,he+=u*Pe,ge+=u*Xe,ie+=u*Ze,u=A[4],de+=u*Ue,we+=u*Ce,Fe+=u*Me,Te+=u*je,ye+=u*Be,pe+=u*Ne,fe+=u*Ge,ue+=u*ke,ce+=u*We,oe+=u*Ye,se+=u*Je,te+=u*qe,he+=u*He,ge+=u*Pe,ie+=u*Xe,be+=u*Ze,u=A[5],we+=u*Ue,Fe+=u*Ce,Te+=u*Me,ye+=u*je,pe+=u*Be,fe+=u*Ne,ue+=u*Ge,ce+=u*ke,oe+=u*We,se+=u*Ye,te+=u*Je,he+=u*qe,ge+=u*He,ie+=u*Pe,be+=u*Xe,ve+=u*Ze,u=A[6],Fe+=u*Ue,Te+=u*Ce,ye+=u*Me,pe+=u*je,fe+=u*Be,ue+=u*Ne,ce+=u*Ge,oe+=u*ke,se+=u*We,te+=u*Ye,he+=u*Je,ge+=u*qe,ie+=u*He,be+=u*Pe,ve+=u*Xe,Ee+=u*Ze,u=A[7],Te+=u*Ue,ye+=u*Ce,pe+=u*Me,fe+=u*je,ue+=u*Be,ce+=u*Ne,oe+=u*Ge,se+=u*ke,te+=u*We,he+=u*Ye,ge+=u*Je,ie+=u*qe,be+=u*He,ve+=u*Pe,Ee+=u*Xe,De+=u*Ze,u=A[8],ye+=u*Ue,pe+=u*Ce,fe+=u*Me,ue+=u*je,ce+=u*Be,oe+=u*Ne,se+=u*Ge,te+=u*ke,he+=u*We,ge+=u*Ye,ie+=u*Je,be+=u*qe,ve+=u*He,Ee+=u*Pe,De+=u*Xe,me+=u*Ze,u=A[9],pe+=u*Ue,fe+=u*Ce,ue+=u*Me,ce+=u*je,oe+=u*Be,se+=u*Ne,te+=u*Ge,he+=u*ke,ge+=u*We,ie+=u*Ye,be+=u*Je,ve+=u*qe,Ee+=u*He,De+=u*Pe,me+=u*Xe,mt+=u*Ze,u=A[10],fe+=u*Ue,ue+=u*Ce,ce+=u*Me,oe+=u*je,se+=u*Be,te+=u*Ne,he+=u*Ge,ge+=u*ke,ie+=u*We,be+=u*Ye,ve+=u*Je,Ee+=u*qe,De+=u*He,me+=u*Pe,mt+=u*Xe,Pt+=u*Ze,u=A[11],ue+=u*Ue,ce+=u*Ce,oe+=u*Me,se+=u*je,te+=u*Be,he+=u*Ne,ge+=u*Ge,ie+=u*ke,be+=u*We,ve+=u*Ye,Ee+=u*Je,De+=u*qe,me+=u*He,mt+=u*Pe,Pt+=u*Xe,Ut+=u*Ze,u=A[12],ce+=u*Ue,oe+=u*Ce,se+=u*Me,te+=u*je,he+=u*Be,ge+=u*Ne,ie+=u*Ge,be+=u*ke,ve+=u*We,Ee+=u*Ye,De+=u*Je,me+=u*qe,mt+=u*He,Pt+=u*Pe,Ut+=u*Xe,pt+=u*Ze,u=A[13],oe+=u*Ue,se+=u*Ce,te+=u*Me,he+=u*je,ge+=u*Be,ie+=u*Ne,be+=u*Ge,ve+=u*ke,Ee+=u*We,De+=u*Ye,me+=u*Je,mt+=u*qe,Pt+=u*He,Ut+=u*Pe,pt+=u*Xe,Zt+=u*Ze,u=A[14],se+=u*Ue,te+=u*Ce,he+=u*Me,ge+=u*je,ie+=u*Be,be+=u*Ne,ve+=u*Ge,Ee+=u*ke,De+=u*We,me+=u*Ye,mt+=u*Je,Pt+=u*qe,Ut+=u*He,pt+=u*Pe,Zt+=u*Xe,Kr+=u*Ze,u=A[15],te+=u*Ue,he+=u*Ce,ge+=u*Me,ie+=u*je,be+=u*Be,ve+=u*Ne,Ee+=u*Ge,De+=u*ke,me+=u*We,mt+=u*Ye,Pt+=u*Je,Ut+=u*qe,pt+=u*He,Zt+=u*Pe,Kr+=u*Xe,Ei+=u*Ze,K+=38*he,k+=38*ge,le+=38*ie,_e+=38*be,de+=38*ve,we+=38*Ee,Fe+=38*De,Te+=38*me,ye+=38*mt,pe+=38*Pt,fe+=38*Ut,ue+=38*pt,ce+=38*Zt,oe+=38*Kr,se+=38*Ei,v=1,u=K+v+65535,v=Math.floor(u/65536),K=u-v*65536,u=k+v+65535,v=Math.floor(u/65536),k=u-v*65536,u=le+v+65535,v=Math.floor(u/65536),le=u-v*65536,u=_e+v+65535,v=Math.floor(u/65536),_e=u-v*65536,u=de+v+65535,v=Math.floor(u/65536),de=u-v*65536,u=we+v+65535,v=Math.floor(u/65536),we=u-v*65536,u=Fe+v+65535,v=Math.floor(u/65536),Fe=u-v*65536,u=Te+v+65535,v=Math.floor(u/65536),Te=u-v*65536,u=ye+v+65535,v=Math.floor(u/65536),ye=u-v*65536,u=pe+v+65535,v=Math.floor(u/65536),pe=u-v*65536,u=fe+v+65535,v=Math.floor(u/65536),fe=u-v*65536,u=ue+v+65535,v=Math.floor(u/65536),ue=u-v*65536,u=ce+v+65535,v=Math.floor(u/65536),ce=u-v*65536,u=oe+v+65535,v=Math.floor(u/65536),oe=u-v*65536,u=se+v+65535,v=Math.floor(u/65536),se=u-v*65536,u=te+v+65535,v=Math.floor(u/65536),te=u-v*65536,K+=v-1+37*(v-1),v=1,u=K+v+65535,v=Math.floor(u/65536),K=u-v*65536,u=k+v+65535,v=Math.floor(u/65536),k=u-v*65536,u=le+v+65535,v=Math.floor(u/65536),le=u-v*65536,u=_e+v+65535,v=Math.floor(u/65536),_e=u-v*65536,u=de+v+65535,v=Math.floor(u/65536),de=u-v*65536,u=we+v+65535,v=Math.floor(u/65536),we=u-v*65536,u=Fe+v+65535,v=Math.floor(u/65536),Fe=u-v*65536,u=Te+v+65535,v=Math.floor(u/65536),Te=u-v*65536,u=ye+v+65535,v=Math.floor(u/65536),ye=u-v*65536,u=pe+v+65535,v=Math.floor(u/65536),pe=u-v*65536,u=fe+v+65535,v=Math.floor(u/65536),fe=u-v*65536,u=ue+v+65535,v=Math.floor(u/65536),ue=u-v*65536,u=ce+v+65535,v=Math.floor(u/65536),ce=u-v*65536,u=oe+v+65535,v=Math.floor(u/65536),oe=u-v*65536,u=se+v+65535,v=Math.floor(u/65536),se=u-v*65536,u=te+v+65535,v=Math.floor(u/65536),te=u-v*65536,K+=v-1+37*(v-1),T[0]=K,T[1]=k,T[2]=le,T[3]=_e,T[4]=de,T[5]=we,T[6]=Fe,T[7]=Te,T[8]=ye,T[9]=pe,T[10]=fe,T[11]=ue,T[12]=ce,T[13]=oe,T[14]=se,T[15]=te}function d(T,A){a(T,A,A)}function M(T,A){const O=n();let u;for(u=0;u<16;u++)O[u]=A[u];for(u=253;u>=0;u--)d(O,O),u!==2&&u!==4&&a(O,O,A);for(u=0;u<16;u++)T[u]=O[u]}function q(T,A){const O=n();let u;for(u=0;u<16;u++)O[u]=A[u];for(u=250;u>=0;u--)d(O,O),u!==1&&a(O,O,A);for(u=0;u<16;u++)T[u]=O[u]}function G(T,A){const O=n(),u=n(),v=n(),K=n(),k=n(),le=n(),_e=n(),de=n(),we=n();E(O,T[1],T[0]),E(we,A[1],A[0]),a(O,O,we),D(u,T[0],T[1]),D(we,A[0],A[1]),a(u,u,we),a(v,T[3],A[3]),a(v,v,h),a(K,T[2],A[2]),D(K,K,K),E(k,u,O),E(le,K,v),D(_e,K,v),D(de,u,O),a(T[0],k,le),a(T[1],de,_e),a(T[2],_e,le),a(T[3],k,de)}function J(T,A,O){for(let u=0;u<4;u++)R(T[u],A[u],O)}function X(T,A){const O=n(),u=n(),v=n();M(v,A[2]),a(O,A[0],v),a(u,A[1],v),L(T,u),T[31]^=P(O)<<7}function g(T,A,O){S(T[0],o),S(T[1],c),S(T[2],c),S(T[3],o);for(let u=255;u>=0;--u){const v=O[u/8|0]>>(u&7)&1;J(T,A,v),G(A,T),G(T,T),J(T,A,v)}}function b(T,A){const O=[n(),n(),n(),n()];S(O[0],f),S(O[1],_),S(O[2],c),a(O[3],f,_),g(T,O,A)}function $(T){if(T.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const A=(0,r.hash)(T);A[0]&=248,A[31]&=127,A[31]|=64;const O=new Uint8Array(32),u=[n(),n(),n(),n()];b(u,A),X(O,u);const v=new Uint8Array(64);return v.set(T),v.set(O,32),{publicKey:O,secretKey:v}}t.generateKeyPairFromSeed=$;function U(T){const A=(0,e.randomBytes)(32,T),O=$(A);return(0,i.wipe)(A),O}t.generateKeyPair=U;function N(T){if(T.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(T.subarray(32))}t.extractPublicKeyFromSecretKey=N;const C=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function j(T,A){let O,u,v,K;for(u=63;u>=32;--u){for(O=0,v=u-32,K=u-12;v<K;++v)A[v]+=O-16*A[u]*C[v-(u-32)],O=Math.floor((A[v]+128)/256),A[v]-=O*256;A[v]+=O,A[u]=0}for(O=0,v=0;v<32;v++)A[v]+=O-(A[31]>>4)*C[v],O=A[v]>>8,A[v]&=255;for(v=0;v<32;v++)A[v]-=O*C[v];for(u=0;u<32;u++)A[u+1]+=A[u]>>8,T[u]=A[u]&255}function B(T){const A=new Float64Array(64);for(let O=0;O<64;O++)A[O]=T[O];for(let O=0;O<64;O++)T[O]=0;j(T,A)}function Q(T,A){const O=new Float64Array(64),u=[n(),n(),n(),n()],v=(0,r.hash)(T.subarray(0,32));v[0]&=248,v[31]&=127,v[31]|=64;const K=new Uint8Array(64);K.set(v.subarray(32),32);const k=new r.SHA512;k.update(K.subarray(32)),k.update(A);const le=k.digest();k.clean(),B(le),b(u,le),X(K,u),k.reset(),k.update(K.subarray(0,32)),k.update(T.subarray(32)),k.update(A);const _e=k.digest();B(_e);for(let de=0;de<32;de++)O[de]=le[de];for(let de=0;de<32;de++)for(let we=0;we<32;we++)O[de+we]+=_e[de]*v[we];return j(K.subarray(32),O),K}t.sign=Q;function z(T,A){const O=n(),u=n(),v=n(),K=n(),k=n(),le=n(),_e=n();return S(T[2],c),y(T[1],A),d(v,T[1]),a(K,v,l),E(v,v,T[2]),D(K,T[2],K),d(k,K),d(le,k),a(_e,le,k),a(O,_e,v),a(O,O,K),q(O,O),a(O,O,v),a(O,O,K),a(O,O,K),a(T[0],O,K),d(u,T[0]),a(u,u,K),x(u,v)&&a(T[0],T[0],w),d(u,T[0]),a(u,u,K),x(u,v)?-1:(P(T[0])===A[31]>>7&&E(T[0],o,T[0]),a(T[3],T[0],T[1]),0)}function ee(T,A,O){const u=new Uint8Array(32),v=[n(),n(),n(),n()],K=[n(),n(),n(),n()];if(O.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(z(K,T))return!1;const k=new r.SHA512;k.update(O.subarray(0,32)),k.update(T),k.update(A);const le=k.digest();return B(le),g(v,K,le),b(K,O.subarray(32)),G(v,K),X(u,v),!H(O,u)}t.verify=ee;function Y(T){let A=[n(),n(),n(),n()];if(z(A,T))throw new Error("Ed25519: invalid public key");let O=n(),u=n(),v=A[1];D(O,c,v),E(u,c,v),M(u,u),a(O,O,u);let K=new Uint8Array(32);return L(K,O),K}t.convertPublicKeyToX25519=Y;function ae(T){const A=(0,r.hash)(T.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const O=new Uint8Array(A.subarray(0,32));return(0,i.wipe)(A),O}t.convertSecretKeyToX25519=ae}(Xi);const vl="EdDSA",wl="JWT",Vs=".",Gs="base64url",ml="utf8",El="utf8",Dl=":",Sl="did",xl="key",ks="base58btc",Ol="z",Il="K36",Pl=32;function Ws(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function rn(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=Ws(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}function Al(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var c=t.length,l=t.charAt(0),h=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function _(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var R=0,L=0,H=0,x=m.length;H!==x&&m[H]===0;)H++,R++;for(var P=(x-H)*f+1>>>0,y=new Uint8Array(P);H!==x;){for(var D=m[H],E=0,a=P-1;(D!==0||E<L)&&a!==-1;a--,E++)D+=256*y[a]>>>0,y[a]=D%c>>>0,D=D/c>>>0;if(D!==0)throw new Error("Non-zero carry");L=E,H++}for(var d=P-L;d!==P&&y[d]===0;)d++;for(var M=l.repeat(R);d<P;++d)M+=t.charAt(y[d]);return M}function w(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var R=0;if(m[R]!==" "){for(var L=0,H=0;m[R]===l;)L++,R++;for(var x=(m.length-R)*h+1>>>0,P=new Uint8Array(x);m[R];){var y=r[m.charCodeAt(R)];if(y===255)return;for(var D=0,E=x-1;(y!==0||D<H)&&E!==-1;E--,D++)y+=c*P[E]>>>0,P[E]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");H=D,R++}if(m[R]!==" "){for(var a=x-H;a!==x&&P[a]===0;)a++;for(var d=new Uint8Array(L+(x-a)),M=L;a!==x;)d[M++]=P[a++];return d}}}function S(m){var R=w(m);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:_,decodeUnsafe:w,decode:S}}var Tl=Al,Cl=Tl;const Ys=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Nl=t=>new TextEncoder().encode(t),Rl=t=>new TextDecoder().decode(t);class Ll{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Fl{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Js(this,e)}}class $l{constructor(e){this.decoders=e}or(e){return Js(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Js=(t,e)=>new $l({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Ul{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new Ll(e,r,i),this.decoder=new Fl(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const si=({name:t,prefix:e,encode:r,decode:i})=>new Ul(t,e,r,i),Ar=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=Cl(r,e);return si({prefix:t,name:e,encode:i,decode:s=>Ys(n(s))})},Ml=(t,e,r,i)=>{const n={};for(let f=0;f<e.length;++f)n[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let c=0,l=0,h=0;for(let f=0;f<s;++f){const _=n[t[f]];if(_===void 0)throw new SyntaxError(`Non-${i} character`);l=l<<r|_,c+=r,c>=8&&(c-=8,o[h++]=255&l>>c)}if(c>=r||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return o},jl=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,c=0;for(let l=0;l<t.length;++l)for(c=c<<8|t[l],o+=8;o>r;)o-=r,s+=e[n&c>>o];if(o&&(s+=e[n&c<<r-o]),i)for(;s.length*r&7;)s+="=";return s},et=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>si({prefix:e,name:t,encode(n){return jl(n,i,r)},decode(n){return Ml(n,i,r,t)}}),Bl=si({prefix:"\0",name:"identity",encode:t=>Rl(t),decode:t=>Nl(t)});var Hl=Object.freeze({__proto__:null,identity:Bl});const ql=et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var zl=Object.freeze({__proto__:null,base2:ql});const Kl=et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Vl=Object.freeze({__proto__:null,base8:Kl});const Gl=Ar({prefix:"9",name:"base10",alphabet:"0123456789"});var kl=Object.freeze({__proto__:null,base10:Gl});const Wl=et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Yl=et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Jl=Object.freeze({__proto__:null,base16:Wl,base16upper:Yl});const Xl=et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Zl=et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ql=et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ef=et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),tf=et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rf=et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),nf=et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),sf=et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),of=et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var af=Object.freeze({__proto__:null,base32:Xl,base32upper:Zl,base32pad:Ql,base32padupper:ef,base32hex:tf,base32hexupper:rf,base32hexpad:nf,base32hexpadupper:sf,base32z:of});const cf=Ar({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),uf=Ar({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var hf=Object.freeze({__proto__:null,base36:cf,base36upper:uf});const lf=Ar({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ff=Ar({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var df=Object.freeze({__proto__:null,base58btc:lf,base58flickr:ff});const pf=et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gf=et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),yf=et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_f=et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var bf=Object.freeze({__proto__:null,base64:pf,base64pad:gf,base64url:yf,base64urlpad:_f});const Xs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),vf=Xs.reduce((t,e,r)=>(t[r]=e,t),[]),wf=Xs.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function mf(t){return t.reduce((e,r)=>(e+=vf[r],e),"")}function Ef(t){const e=[];for(const r of t){const i=wf[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Df=si({prefix:"\u{1F680}",name:"base256emoji",encode:mf,decode:Ef});var Sf=Object.freeze({__proto__:null,base256emoji:Df}),xf=Qs,Zs=128,Of=127,If=~Of,Pf=Math.pow(2,31);function Qs(t,e,r){e=e||[],r=r||0;for(var i=r;t>=Pf;)e[r++]=t&255|Zs,t/=128;for(;t&If;)e[r++]=t&255|Zs,t>>>=7;return e[r]=t|0,Qs.bytes=r-i+1,e}var Af=nn,Tf=128,eo=127;function nn(t,i){var r=0,i=i||0,n=0,s=i,o,c=t.length;do{if(s>=c)throw nn.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&eo)<<n:(o&eo)*Math.pow(2,n),n+=7}while(o>=Tf);return nn.bytes=s-i,r}var Cf=Math.pow(2,7),Nf=Math.pow(2,14),Rf=Math.pow(2,21),Lf=Math.pow(2,28),Ff=Math.pow(2,35),$f=Math.pow(2,42),Uf=Math.pow(2,49),Mf=Math.pow(2,56),jf=Math.pow(2,63),Bf=function(t){return t<Cf?1:t<Nf?2:t<Rf?3:t<Lf?4:t<Ff?5:t<$f?6:t<Uf?7:t<Mf?8:t<jf?9:10},Hf={encode:xf,decode:Af,encodingLength:Bf},to=Hf;const ro=(t,e,r=0)=>(to.encode(t,e,r),e),io=t=>to.encodingLength(t),sn=(t,e)=>{const r=e.byteLength,i=io(t),n=i+io(r),s=new Uint8Array(n+r);return ro(t,s,0),ro(r,s,i),s.set(e,n),new qf(t,r,e,s)};class qf{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const no=({name:t,code:e,encode:r})=>new zf(t,e,r);class zf{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?sn(this.code,r):r.then(i=>sn(this.code,i))}else throw Error("Unknown type, must be binary type")}}const so=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Kf=no({name:"sha2-256",code:18,encode:so("SHA-256")}),Vf=no({name:"sha2-512",code:19,encode:so("SHA-512")});var Gf=Object.freeze({__proto__:null,sha256:Kf,sha512:Vf});const oo=0,kf="identity",ao=Ys;var Wf=Object.freeze({__proto__:null,identity:{code:oo,name:kf,encode:ao,digest:t=>sn(oo,ao(t))}});new TextEncoder,new TextDecoder;const co={...Hl,...zl,...Vl,...kl,...Jl,...af,...hf,...df,...bf,...Sf};({...Gf,...Wf});function uo(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const ho=uo("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),on=uo("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Ws(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),lo={utf8:ho,"utf-8":ho,hex:co.base16,latin1:on,ascii:on,binary:on,...co};function ut(t,e="utf8"){const r=lo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function ht(t,e="utf8"){const r=lo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function oi(t){return ut(ht(Pr(t),ml),Gs)}function fo(t){const e=ht(Il,ks),r=Ol+ut(rn([e,t]),ks);return[Sl,xl,r].join(Dl)}function Yf(t){return ut(t,Gs)}function Jf(t){return ht([oi(t.header),oi(t.payload)].join(Vs),El)}function Xf(t){return[oi(t.header),oi(t.payload),Yf(t.signature)].join(Vs)}function po(t=ar.randomBytes(Pl)){return Xi.generateKeyPairFromSeed(t)}async function Zf(t,e,r,i,n=Z.fromMiliseconds(Date.now())){const s={alg:vl,typ:wl},o=fo(i.publicKey),c=n+r,l={iss:o,sub:t,aud:e,iat:n,exp:c},h=Jf({header:s,payload:l}),f=Xi.sign(i.secretKey,h);return Xf({header:s,payload:l,signature:f})}var an={},ai={};Object.defineProperty(ai,"__esModule",{value:!0});var nt=re,cn=dt,Qf=20;function ed(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],l=r[7]<<24|r[6]<<16|r[5]<<8|r[4],h=r[11]<<24|r[10]<<16|r[9]<<8|r[8],f=r[15]<<24|r[14]<<16|r[13]<<8|r[12],_=r[19]<<24|r[18]<<16|r[17]<<8|r[16],w=r[23]<<24|r[22]<<16|r[21]<<8|r[20],S=r[27]<<24|r[26]<<16|r[25]<<8|r[24],m=r[31]<<24|r[30]<<16|r[29]<<8|r[28],R=e[3]<<24|e[2]<<16|e[1]<<8|e[0],L=e[7]<<24|e[6]<<16|e[5]<<8|e[4],H=e[11]<<24|e[10]<<16|e[9]<<8|e[8],x=e[15]<<24|e[14]<<16|e[13]<<8|e[12],P=i,y=n,D=s,E=o,a=c,d=l,M=h,q=f,G=_,J=w,X=S,g=m,b=R,$=L,U=H,N=x,C=0;C<Qf;C+=2)P=P+a|0,b^=P,b=b>>>32-16|b<<16,G=G+b|0,a^=G,a=a>>>32-12|a<<12,y=y+d|0,$^=y,$=$>>>32-16|$<<16,J=J+$|0,d^=J,d=d>>>32-12|d<<12,D=D+M|0,U^=D,U=U>>>32-16|U<<16,X=X+U|0,M^=X,M=M>>>32-12|M<<12,E=E+q|0,N^=E,N=N>>>32-16|N<<16,g=g+N|0,q^=g,q=q>>>32-12|q<<12,D=D+M|0,U^=D,U=U>>>32-8|U<<8,X=X+U|0,M^=X,M=M>>>32-7|M<<7,E=E+q|0,N^=E,N=N>>>32-8|N<<8,g=g+N|0,q^=g,q=q>>>32-7|q<<7,y=y+d|0,$^=y,$=$>>>32-8|$<<8,J=J+$|0,d^=J,d=d>>>32-7|d<<7,P=P+a|0,b^=P,b=b>>>32-8|b<<8,G=G+b|0,a^=G,a=a>>>32-7|a<<7,P=P+d|0,N^=P,N=N>>>32-16|N<<16,X=X+N|0,d^=X,d=d>>>32-12|d<<12,y=y+M|0,b^=y,b=b>>>32-16|b<<16,g=g+b|0,M^=g,M=M>>>32-12|M<<12,D=D+q|0,$^=D,$=$>>>32-16|$<<16,G=G+$|0,q^=G,q=q>>>32-12|q<<12,E=E+a|0,U^=E,U=U>>>32-16|U<<16,J=J+U|0,a^=J,a=a>>>32-12|a<<12,D=D+q|0,$^=D,$=$>>>32-8|$<<8,G=G+$|0,q^=G,q=q>>>32-7|q<<7,E=E+a|0,U^=E,U=U>>>32-8|U<<8,J=J+U|0,a^=J,a=a>>>32-7|a<<7,y=y+M|0,b^=y,b=b>>>32-8|b<<8,g=g+b|0,M^=g,M=M>>>32-7|M<<7,P=P+d|0,N^=P,N=N>>>32-8|N<<8,X=X+N|0,d^=X,d=d>>>32-7|d<<7;nt.writeUint32LE(P+i|0,t,0),nt.writeUint32LE(y+n|0,t,4),nt.writeUint32LE(D+s|0,t,8),nt.writeUint32LE(E+o|0,t,12),nt.writeUint32LE(a+c|0,t,16),nt.writeUint32LE(d+l|0,t,20),nt.writeUint32LE(M+h|0,t,24),nt.writeUint32LE(q+f|0,t,28),nt.writeUint32LE(G+_|0,t,32),nt.writeUint32LE(J+w|0,t,36),nt.writeUint32LE(X+S|0,t,40),nt.writeUint32LE(g+m|0,t,44),nt.writeUint32LE(b+R|0,t,48),nt.writeUint32LE($+L|0,t,52),nt.writeUint32LE(U+H|0,t,56),nt.writeUint32LE(N+x|0,t,60)}function go(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var c=new Uint8Array(64),l=0;l<r.length;l+=64){ed(c,s,t);for(var h=l;h<l+64&&h<r.length;h++)i[h]=r[h]^c[h-l];rd(s,0,o)}return cn.wipe(c),n===0&&cn.wipe(s),i}ai.streamXOR=go;function td(t,e,r,i){return i===void 0&&(i=0),cn.wipe(r),go(t,e,r,r,i)}ai.stream=td;function rd(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var yo={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});function id(t,e,r){return~(t-1)&e|t-1&r}Lt.select=id;function nd(t,e){return(t|0)-(e|0)-1>>>31&1}Lt.lessOrEqual=nd;function _o(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}Lt.compare=_o;function sd(t,e){return t.length===0||e.length===0?!1:_o(t,e)!==0}Lt.equal=sd,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Lt,r=dt;t.DIGEST_LENGTH=16;var i=function(){function o(c){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var l=c[0]|c[1]<<8;this._r[0]=l&8191;var h=c[2]|c[3]<<8;this._r[1]=(l>>>13|h<<3)&8191;var f=c[4]|c[5]<<8;this._r[2]=(h>>>10|f<<6)&7939;var _=c[6]|c[7]<<8;this._r[3]=(f>>>7|_<<9)&8191;var w=c[8]|c[9]<<8;this._r[4]=(_>>>4|w<<12)&255,this._r[5]=w>>>1&8190;var S=c[10]|c[11]<<8;this._r[6]=(w>>>14|S<<2)&8191;var m=c[12]|c[13]<<8;this._r[7]=(S>>>11|m<<5)&8065;var R=c[14]|c[15]<<8;this._r[8]=(m>>>8|R<<8)&8191,this._r[9]=R>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return o.prototype._blocks=function(c,l,h){for(var f=this._fin?0:2048,_=this._h[0],w=this._h[1],S=this._h[2],m=this._h[3],R=this._h[4],L=this._h[5],H=this._h[6],x=this._h[7],P=this._h[8],y=this._h[9],D=this._r[0],E=this._r[1],a=this._r[2],d=this._r[3],M=this._r[4],q=this._r[5],G=this._r[6],J=this._r[7],X=this._r[8],g=this._r[9];h>=16;){var b=c[l+0]|c[l+1]<<8;_+=b&8191;var $=c[l+2]|c[l+3]<<8;w+=(b>>>13|$<<3)&8191;var U=c[l+4]|c[l+5]<<8;S+=($>>>10|U<<6)&8191;var N=c[l+6]|c[l+7]<<8;m+=(U>>>7|N<<9)&8191;var C=c[l+8]|c[l+9]<<8;R+=(N>>>4|C<<12)&8191,L+=C>>>1&8191;var j=c[l+10]|c[l+11]<<8;H+=(C>>>14|j<<2)&8191;var B=c[l+12]|c[l+13]<<8;x+=(j>>>11|B<<5)&8191;var Q=c[l+14]|c[l+15]<<8;P+=(B>>>8|Q<<8)&8191,y+=Q>>>5|f;var z=0,ee=z;ee+=_*D,ee+=w*(5*g),ee+=S*(5*X),ee+=m*(5*J),ee+=R*(5*G),z=ee>>>13,ee&=8191,ee+=L*(5*q),ee+=H*(5*M),ee+=x*(5*d),ee+=P*(5*a),ee+=y*(5*E),z+=ee>>>13,ee&=8191;var Y=z;Y+=_*E,Y+=w*D,Y+=S*(5*g),Y+=m*(5*X),Y+=R*(5*J),z=Y>>>13,Y&=8191,Y+=L*(5*G),Y+=H*(5*q),Y+=x*(5*M),Y+=P*(5*d),Y+=y*(5*a),z+=Y>>>13,Y&=8191;var ae=z;ae+=_*a,ae+=w*E,ae+=S*D,ae+=m*(5*g),ae+=R*(5*X),z=ae>>>13,ae&=8191,ae+=L*(5*J),ae+=H*(5*G),ae+=x*(5*q),ae+=P*(5*M),ae+=y*(5*d),z+=ae>>>13,ae&=8191;var T=z;T+=_*d,T+=w*a,T+=S*E,T+=m*D,T+=R*(5*g),z=T>>>13,T&=8191,T+=L*(5*X),T+=H*(5*J),T+=x*(5*G),T+=P*(5*q),T+=y*(5*M),z+=T>>>13,T&=8191;var A=z;A+=_*M,A+=w*d,A+=S*a,A+=m*E,A+=R*D,z=A>>>13,A&=8191,A+=L*(5*g),A+=H*(5*X),A+=x*(5*J),A+=P*(5*G),A+=y*(5*q),z+=A>>>13,A&=8191;var O=z;O+=_*q,O+=w*M,O+=S*d,O+=m*a,O+=R*E,z=O>>>13,O&=8191,O+=L*D,O+=H*(5*g),O+=x*(5*X),O+=P*(5*J),O+=y*(5*G),z+=O>>>13,O&=8191;var u=z;u+=_*G,u+=w*q,u+=S*M,u+=m*d,u+=R*a,z=u>>>13,u&=8191,u+=L*E,u+=H*D,u+=x*(5*g),u+=P*(5*X),u+=y*(5*J),z+=u>>>13,u&=8191;var v=z;v+=_*J,v+=w*G,v+=S*q,v+=m*M,v+=R*d,z=v>>>13,v&=8191,v+=L*a,v+=H*E,v+=x*D,v+=P*(5*g),v+=y*(5*X),z+=v>>>13,v&=8191;var K=z;K+=_*X,K+=w*J,K+=S*G,K+=m*q,K+=R*M,z=K>>>13,K&=8191,K+=L*d,K+=H*a,K+=x*E,K+=P*D,K+=y*(5*g),z+=K>>>13,K&=8191;var k=z;k+=_*g,k+=w*X,k+=S*J,k+=m*G,k+=R*q,z=k>>>13,k&=8191,k+=L*M,k+=H*d,k+=x*a,k+=P*E,k+=y*D,z+=k>>>13,k&=8191,z=(z<<2)+z|0,z=z+ee|0,ee=z&8191,z=z>>>13,Y+=z,_=ee,w=Y,S=ae,m=T,R=A,L=O,H=u,x=v,P=K,y=k,l+=16,h-=16}this._h[0]=_,this._h[1]=w,this._h[2]=S,this._h[3]=m,this._h[4]=R,this._h[5]=L,this._h[6]=H,this._h[7]=x,this._h[8]=P,this._h[9]=y},o.prototype.finish=function(c,l){l===void 0&&(l=0);var h=new Uint16Array(10),f,_,w,S;if(this._leftover){for(S=this._leftover,this._buffer[S++]=1;S<16;S++)this._buffer[S]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(f=this._h[1]>>>13,this._h[1]&=8191,S=2;S<10;S++)this._h[S]+=f,f=this._h[S]>>>13,this._h[S]&=8191;for(this._h[0]+=f*5,f=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=f,f=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=f,h[0]=this._h[0]+5,f=h[0]>>>13,h[0]&=8191,S=1;S<10;S++)h[S]=this._h[S]+f,f=h[S]>>>13,h[S]&=8191;for(h[9]-=1<<13,_=(f^1)-1,S=0;S<10;S++)h[S]&=_;for(_=~_,S=0;S<10;S++)this._h[S]=this._h[S]&_|h[S];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,w=this._h[0]+this._pad[0],this._h[0]=w&65535,S=1;S<8;S++)w=(this._h[S]+this._pad[S]|0)+(w>>>16)|0,this._h[S]=w&65535;return c[l+0]=this._h[0]>>>0,c[l+1]=this._h[0]>>>8,c[l+2]=this._h[1]>>>0,c[l+3]=this._h[1]>>>8,c[l+4]=this._h[2]>>>0,c[l+5]=this._h[2]>>>8,c[l+6]=this._h[3]>>>0,c[l+7]=this._h[3]>>>8,c[l+8]=this._h[4]>>>0,c[l+9]=this._h[4]>>>8,c[l+10]=this._h[5]>>>0,c[l+11]=this._h[5]>>>8,c[l+12]=this._h[6]>>>0,c[l+13]=this._h[6]>>>8,c[l+14]=this._h[7]>>>0,c[l+15]=this._h[7]>>>8,this._finished=!0,this},o.prototype.update=function(c){var l=0,h=c.length,f;if(this._leftover){f=16-this._leftover,f>h&&(f=h);for(var _=0;_<f;_++)this._buffer[this._leftover+_]=c[l+_];if(h-=f,l+=f,this._leftover+=f,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(h>=16&&(f=h-h%16,this._blocks(c,l,f),l+=f,h-=f),h){for(var _=0;_<h;_++)this._buffer[this._leftover+_]=c[l+_];this._leftover+=h}return this},o.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},o.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},o}();t.Poly1305=i;function n(o,c){var l=new i(o);l.update(c);var h=l.digest();return l.clean(),h}t.oneTimeAuth=n;function s(o,c){return o.length!==t.DIGEST_LENGTH||c.length!==t.DIGEST_LENGTH?!1:e.equal(o,c)}t.equal=s}(yo),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ai,r=yo,i=dt,n=re,s=Lt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var o=new Uint8Array(16),c=function(){function l(h){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,h.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(h)}return l.prototype.seal=function(h,f,_,w){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var S=new Uint8Array(16);S.set(h,S.length-h.length);var m=new Uint8Array(32);e.stream(this._key,S,m,4);var R=f.length+this.tagLength,L;if(w){if(w.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");L=w}else L=new Uint8Array(R);return e.streamXOR(this._key,S,f,L,4),this._authenticate(L.subarray(L.length-this.tagLength,L.length),m,L.subarray(0,L.length-this.tagLength),_),i.wipe(S),L},l.prototype.open=function(h,f,_,w){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(f.length<this.tagLength)return null;var S=new Uint8Array(16);S.set(h,S.length-h.length);var m=new Uint8Array(32);e.stream(this._key,S,m,4);var R=new Uint8Array(this.tagLength);if(this._authenticate(R,m,f.subarray(0,f.length-this.tagLength),_),!s.equal(R,f.subarray(f.length-this.tagLength,f.length)))return null;var L=f.length-this.tagLength,H;if(w){if(w.length!==L)throw new Error("ChaCha20Poly1305: incorrect destination length");H=w}else H=new Uint8Array(L);return e.streamXOR(this._key,S,f.subarray(0,f.length-this.tagLength),H,4),i.wipe(S),H},l.prototype.clean=function(){return i.wipe(this._key),this},l.prototype._authenticate=function(h,f,_,w){var S=new r.Poly1305(f);w&&(S.update(w),w.length%16>0&&S.update(o.subarray(w.length%16))),S.update(_),_.length%16>0&&S.update(o.subarray(_.length%16));var m=new Uint8Array(8);w&&n.writeUint64LE(w.length,m),S.update(m),n.writeUint64LE(_.length,m),S.update(m);for(var R=S.digest(),L=0;L<R.length;L++)h[L]=R[L];S.clean(),i.wipe(R),i.wipe(m)},l}();t.ChaCha20Poly1305=c}(an);var bo={},Tr={},un={};Object.defineProperty(un,"__esModule",{value:!0});function od(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}un.isSerializableHash=od,Object.defineProperty(Tr,"__esModule",{value:!0});var St=un,ad=Lt,cd=dt,vo=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),St.isSerializableHash(this._inner)&&St.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),cd.wipe(i)}return t.prototype.reset=function(){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){St.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),St.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Tr.HMAC=vo;function ud(t,e,r){var i=new vo(t,e);i.update(r);var n=i.digest();return i.clean(),n}Tr.hmac=ud,Tr.equal=ad.equal,Object.defineProperty(bo,"__esModule",{value:!0});var wo=Tr,mo=dt,hd=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=wo.hmac(this._hash,i,r);this._hmac=new wo.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),mo.wipe(this._buffer),mo.wipe(this._counter),this._bufpos=0},t}(),ld=bo.HKDF=hd,ci={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=dt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(l,h){if(h===void 0&&(h=l.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var f=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&h>0;)this._buffer[this._bufferLength++]=l[f++],h--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(f=s(this._temp,this._state,l,f,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=l[f++],h--;return this},c.prototype.finish=function(l){if(!this._finished){var h=this._bytesHashed,f=this._bufferLength,_=h/536870912|0,w=h<<3,S=h%64<56?64:128;this._buffer[f]=128;for(var m=f+1;m<S-8;m++)this._buffer[m]=0;e.writeUint32BE(_,this._buffer,S-8),e.writeUint32BE(w,this._buffer,S-4),s(this._temp,this._state,this._buffer,0,S),this._finished=!0}for(var m=0;m<this.digestLength/4;m++)e.writeUint32BE(this._state[m],l,m*4);return this},c.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(l){return this._state.set(l.state),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(l){r.wipe(l.state),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},c}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,l,h,f,_){for(;_>=64;){for(var w=l[0],S=l[1],m=l[2],R=l[3],L=l[4],H=l[5],x=l[6],P=l[7],y=0;y<16;y++){var D=f+y*4;c[y]=e.readUint32BE(h,D)}for(var y=16;y<64;y++){var E=c[y-2],a=(E>>>17|E<<32-17)^(E>>>19|E<<32-19)^E>>>10;E=c[y-15];var d=(E>>>7|E<<32-7)^(E>>>18|E<<32-18)^E>>>3;c[y]=(a+c[y-7]|0)+(d+c[y-16]|0)}for(var y=0;y<64;y++){var a=(((L>>>6|L<<26)^(L>>>11|L<<21)^(L>>>25|L<<7))+(L&H^~L&x)|0)+(P+(n[y]+c[y]|0)|0)|0,d=((w>>>2|w<<32-2)^(w>>>13|w<<32-13)^(w>>>22|w<<32-22))+(w&S^w&m^S&m)|0;P=x,x=H,H=L,L=R+a|0,R=m,m=S,S=w,w=a+d|0}l[0]+=w,l[1]+=S,l[2]+=m,l[3]+=R,l[4]+=L,l[5]+=H,l[6]+=x,l[7]+=P,f+=64,_-=64}return f}function o(c){var l=new i;l.update(c);var h=l.digest();return l.clean(),h}t.hash=o})(ci);var hn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=ar,r=dt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(y){const D=new Float64Array(16);if(y)for(let E=0;E<y.length;E++)D[E]=y[E];return D}const n=new Uint8Array(32);n[0]=9;const s=i([56129,1]);function o(y){let D=1;for(let E=0;E<16;E++){let a=y[E]+D+65535;D=Math.floor(a/65536),y[E]=a-D*65536}y[0]+=D-1+37*(D-1)}function c(y,D,E){const a=~(E-1);for(let d=0;d<16;d++){const M=a&(y[d]^D[d]);y[d]^=M,D[d]^=M}}function l(y,D){const E=i(),a=i();for(let d=0;d<16;d++)a[d]=D[d];o(a),o(a),o(a);for(let d=0;d<2;d++){E[0]=a[0]-65517;for(let q=1;q<15;q++)E[q]=a[q]-65535-(E[q-1]>>16&1),E[q-1]&=65535;E[15]=a[15]-32767-(E[14]>>16&1);const M=E[15]>>16&1;E[14]&=65535,c(a,E,1-M)}for(let d=0;d<16;d++)y[2*d]=a[d]&255,y[2*d+1]=a[d]>>8}function h(y,D){for(let E=0;E<16;E++)y[E]=D[2*E]+(D[2*E+1]<<8);y[15]&=32767}function f(y,D,E){for(let a=0;a<16;a++)y[a]=D[a]+E[a]}function _(y,D,E){for(let a=0;a<16;a++)y[a]=D[a]-E[a]}function w(y,D,E){let a,d,M=0,q=0,G=0,J=0,X=0,g=0,b=0,$=0,U=0,N=0,C=0,j=0,B=0,Q=0,z=0,ee=0,Y=0,ae=0,T=0,A=0,O=0,u=0,v=0,K=0,k=0,le=0,_e=0,de=0,we=0,Fe=0,Te=0,ye=E[0],pe=E[1],fe=E[2],ue=E[3],ce=E[4],oe=E[5],se=E[6],te=E[7],he=E[8],ge=E[9],ie=E[10],be=E[11],ve=E[12],Ee=E[13],De=E[14],me=E[15];a=D[0],M+=a*ye,q+=a*pe,G+=a*fe,J+=a*ue,X+=a*ce,g+=a*oe,b+=a*se,$+=a*te,U+=a*he,N+=a*ge,C+=a*ie,j+=a*be,B+=a*ve,Q+=a*Ee,z+=a*De,ee+=a*me,a=D[1],q+=a*ye,G+=a*pe,J+=a*fe,X+=a*ue,g+=a*ce,b+=a*oe,$+=a*se,U+=a*te,N+=a*he,C+=a*ge,j+=a*ie,B+=a*be,Q+=a*ve,z+=a*Ee,ee+=a*De,Y+=a*me,a=D[2],G+=a*ye,J+=a*pe,X+=a*fe,g+=a*ue,b+=a*ce,$+=a*oe,U+=a*se,N+=a*te,C+=a*he,j+=a*ge,B+=a*ie,Q+=a*be,z+=a*ve,ee+=a*Ee,Y+=a*De,ae+=a*me,a=D[3],J+=a*ye,X+=a*pe,g+=a*fe,b+=a*ue,$+=a*ce,U+=a*oe,N+=a*se,C+=a*te,j+=a*he,B+=a*ge,Q+=a*ie,z+=a*be,ee+=a*ve,Y+=a*Ee,ae+=a*De,T+=a*me,a=D[4],X+=a*ye,g+=a*pe,b+=a*fe,$+=a*ue,U+=a*ce,N+=a*oe,C+=a*se,j+=a*te,B+=a*he,Q+=a*ge,z+=a*ie,ee+=a*be,Y+=a*ve,ae+=a*Ee,T+=a*De,A+=a*me,a=D[5],g+=a*ye,b+=a*pe,$+=a*fe,U+=a*ue,N+=a*ce,C+=a*oe,j+=a*se,B+=a*te,Q+=a*he,z+=a*ge,ee+=a*ie,Y+=a*be,ae+=a*ve,T+=a*Ee,A+=a*De,O+=a*me,a=D[6],b+=a*ye,$+=a*pe,U+=a*fe,N+=a*ue,C+=a*ce,j+=a*oe,B+=a*se,Q+=a*te,z+=a*he,ee+=a*ge,Y+=a*ie,ae+=a*be,T+=a*ve,A+=a*Ee,O+=a*De,u+=a*me,a=D[7],$+=a*ye,U+=a*pe,N+=a*fe,C+=a*ue,j+=a*ce,B+=a*oe,Q+=a*se,z+=a*te,ee+=a*he,Y+=a*ge,ae+=a*ie,T+=a*be,A+=a*ve,O+=a*Ee,u+=a*De,v+=a*me,a=D[8],U+=a*ye,N+=a*pe,C+=a*fe,j+=a*ue,B+=a*ce,Q+=a*oe,z+=a*se,ee+=a*te,Y+=a*he,ae+=a*ge,T+=a*ie,A+=a*be,O+=a*ve,u+=a*Ee,v+=a*De,K+=a*me,a=D[9],N+=a*ye,C+=a*pe,j+=a*fe,B+=a*ue,Q+=a*ce,z+=a*oe,ee+=a*se,Y+=a*te,ae+=a*he,T+=a*ge,A+=a*ie,O+=a*be,u+=a*ve,v+=a*Ee,K+=a*De,k+=a*me,a=D[10],C+=a*ye,j+=a*pe,B+=a*fe,Q+=a*ue,z+=a*ce,ee+=a*oe,Y+=a*se,ae+=a*te,T+=a*he,A+=a*ge,O+=a*ie,u+=a*be,v+=a*ve,K+=a*Ee,k+=a*De,le+=a*me,a=D[11],j+=a*ye,B+=a*pe,Q+=a*fe,z+=a*ue,ee+=a*ce,Y+=a*oe,ae+=a*se,T+=a*te,A+=a*he,O+=a*ge,u+=a*ie,v+=a*be,K+=a*ve,k+=a*Ee,le+=a*De,_e+=a*me,a=D[12],B+=a*ye,Q+=a*pe,z+=a*fe,ee+=a*ue,Y+=a*ce,ae+=a*oe,T+=a*se,A+=a*te,O+=a*he,u+=a*ge,v+=a*ie,K+=a*be,k+=a*ve,le+=a*Ee,_e+=a*De,de+=a*me,a=D[13],Q+=a*ye,z+=a*pe,ee+=a*fe,Y+=a*ue,ae+=a*ce,T+=a*oe,A+=a*se,O+=a*te,u+=a*he,v+=a*ge,K+=a*ie,k+=a*be,le+=a*ve,_e+=a*Ee,de+=a*De,we+=a*me,a=D[14],z+=a*ye,ee+=a*pe,Y+=a*fe,ae+=a*ue,T+=a*ce,A+=a*oe,O+=a*se,u+=a*te,v+=a*he,K+=a*ge,k+=a*ie,le+=a*be,_e+=a*ve,de+=a*Ee,we+=a*De,Fe+=a*me,a=D[15],ee+=a*ye,Y+=a*pe,ae+=a*fe,T+=a*ue,A+=a*ce,O+=a*oe,u+=a*se,v+=a*te,K+=a*he,k+=a*ge,le+=a*ie,_e+=a*be,de+=a*ve,we+=a*Ee,Fe+=a*De,Te+=a*me,M+=38*Y,q+=38*ae,G+=38*T,J+=38*A,X+=38*O,g+=38*u,b+=38*v,$+=38*K,U+=38*k,N+=38*le,C+=38*_e,j+=38*de,B+=38*we,Q+=38*Fe,z+=38*Te,d=1,a=M+d+65535,d=Math.floor(a/65536),M=a-d*65536,a=q+d+65535,d=Math.floor(a/65536),q=a-d*65536,a=G+d+65535,d=Math.floor(a/65536),G=a-d*65536,a=J+d+65535,d=Math.floor(a/65536),J=a-d*65536,a=X+d+65535,d=Math.floor(a/65536),X=a-d*65536,a=g+d+65535,d=Math.floor(a/65536),g=a-d*65536,a=b+d+65535,d=Math.floor(a/65536),b=a-d*65536,a=$+d+65535,d=Math.floor(a/65536),$=a-d*65536,a=U+d+65535,d=Math.floor(a/65536),U=a-d*65536,a=N+d+65535,d=Math.floor(a/65536),N=a-d*65536,a=C+d+65535,d=Math.floor(a/65536),C=a-d*65536,a=j+d+65535,d=Math.floor(a/65536),j=a-d*65536,a=B+d+65535,d=Math.floor(a/65536),B=a-d*65536,a=Q+d+65535,d=Math.floor(a/65536),Q=a-d*65536,a=z+d+65535,d=Math.floor(a/65536),z=a-d*65536,a=ee+d+65535,d=Math.floor(a/65536),ee=a-d*65536,M+=d-1+37*(d-1),d=1,a=M+d+65535,d=Math.floor(a/65536),M=a-d*65536,a=q+d+65535,d=Math.floor(a/65536),q=a-d*65536,a=G+d+65535,d=Math.floor(a/65536),G=a-d*65536,a=J+d+65535,d=Math.floor(a/65536),J=a-d*65536,a=X+d+65535,d=Math.floor(a/65536),X=a-d*65536,a=g+d+65535,d=Math.floor(a/65536),g=a-d*65536,a=b+d+65535,d=Math.floor(a/65536),b=a-d*65536,a=$+d+65535,d=Math.floor(a/65536),$=a-d*65536,a=U+d+65535,d=Math.floor(a/65536),U=a-d*65536,a=N+d+65535,d=Math.floor(a/65536),N=a-d*65536,a=C+d+65535,d=Math.floor(a/65536),C=a-d*65536,a=j+d+65535,d=Math.floor(a/65536),j=a-d*65536,a=B+d+65535,d=Math.floor(a/65536),B=a-d*65536,a=Q+d+65535,d=Math.floor(a/65536),Q=a-d*65536,a=z+d+65535,d=Math.floor(a/65536),z=a-d*65536,a=ee+d+65535,d=Math.floor(a/65536),ee=a-d*65536,M+=d-1+37*(d-1),y[0]=M,y[1]=q,y[2]=G,y[3]=J,y[4]=X,y[5]=g,y[6]=b,y[7]=$,y[8]=U,y[9]=N,y[10]=C,y[11]=j,y[12]=B,y[13]=Q,y[14]=z,y[15]=ee}function S(y,D){w(y,D,D)}function m(y,D){const E=i();for(let a=0;a<16;a++)E[a]=D[a];for(let a=253;a>=0;a--)S(E,E),a!==2&&a!==4&&w(E,E,D);for(let a=0;a<16;a++)y[a]=E[a]}function R(y,D){const E=new Uint8Array(32),a=new Float64Array(80),d=i(),M=i(),q=i(),G=i(),J=i(),X=i();for(let U=0;U<31;U++)E[U]=y[U];E[31]=y[31]&127|64,E[0]&=248,h(a,D);for(let U=0;U<16;U++)M[U]=a[U];d[0]=G[0]=1;for(let U=254;U>=0;--U){const N=E[U>>>3]>>>(U&7)&1;c(d,M,N),c(q,G,N),f(J,d,q),_(d,d,q),f(q,M,G),_(M,M,G),S(G,J),S(X,d),w(d,q,d),w(q,M,J),f(J,d,q),_(d,d,q),S(M,d),_(q,G,X),w(d,q,s),f(d,d,G),w(q,q,d),w(d,G,X),w(G,M,a),S(M,J),c(d,M,N),c(q,G,N)}for(let U=0;U<16;U++)a[U+16]=d[U],a[U+32]=q[U],a[U+48]=M[U],a[U+64]=G[U];const g=a.subarray(32),b=a.subarray(16);m(g,g),w(b,b,g);const $=new Uint8Array(32);return l($,b),$}t.scalarMult=R;function L(y){return R(y,n)}t.scalarMultBase=L;function H(y){if(y.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const D=new Uint8Array(y);return{publicKey:L(D),secretKey:D}}t.generateKeyPairFromSeed=H;function x(y){const D=(0,e.randomBytes)(32,y),E=H(D);return(0,r.wipe)(D),E}t.generateKeyPair=x;function P(y,D,E=!1){if(y.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(D.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const a=R(y,D);if(E){let d=0;for(let M=0;M<a.length;M++)d|=a[M];if(d===0)throw new Error("X25519: invalid shared key")}return a}t.sharedKey=P})(hn);var Eo=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},fd=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),dd=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),pd=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),gd=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),yd=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),_d=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,bd=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Do=3,vd=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",_d]],So=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function wd(t){return t?xo(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new yd:typeof navigator<"u"?xo(navigator.userAgent):Dd()}function md(t){return t!==""&&vd.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function xo(t){var e=md(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new gd;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<Do&&(n=Eo(Eo([],n,!0),Sd(Do-n.length),!0)):n=[];var s=n.join("."),o=Ed(t),c=bd.exec(t);return c&&c[1]?new pd(r,s,o,c[1]):new fd(r,s,o)}function Ed(t){for(var e=0,r=So.length;e<r;e++){var i=So[e],n=i[0],s=i[1],o=s.exec(t);if(o)return n}return null}function Dd(){var t=typeof process<"u"&&process.version;return t?new dd(process.version.slice(1)):null}function Sd(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=Io=Oe.getLocation=Oe.getLocationOrThrow=ln=Oe.getNavigator=Oe.getNavigatorOrThrow=Oo=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function Wt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Oe.getFromWindow=Wt;function cr(t){const e=Wt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Oe.getFromWindowOrThrow=cr;function xd(){return cr("document")}Oe.getDocumentOrThrow=xd;function Od(){return Wt("document")}var Oo=Oe.getDocument=Od;function Id(){return cr("navigator")}Oe.getNavigatorOrThrow=Id;function Pd(){return Wt("navigator")}var ln=Oe.getNavigator=Pd;function Ad(){return cr("location")}Oe.getLocationOrThrow=Ad;function Td(){return Wt("location")}var Io=Oe.getLocation=Td;function Cd(){return cr("crypto")}Oe.getCryptoOrThrow=Cd;function Nd(){return Wt("crypto")}Oe.getCrypto=Nd;function Rd(){return cr("localStorage")}Oe.getLocalStorageOrThrow=Rd;function Ld(){return Wt("localStorage")}Oe.getLocalStorage=Ld;var fn={};Object.defineProperty(fn,"__esModule",{value:!0});var Po=fn.getWindowMetadata=void 0;const Ao=Oe;function Fd(){let t,e;try{t=Ao.getDocumentOrThrow(),e=Ao.getLocationOrThrow()}catch{return null}function r(){const _=t.getElementsByTagName("link"),w=[];for(let S=0;S<_.length;S++){const m=_[S],R=m.getAttribute("rel");if(R&&R.toLowerCase().indexOf("icon")>-1){const L=m.getAttribute("href");if(L)if(L.toLowerCase().indexOf("https:")===-1&&L.toLowerCase().indexOf("http:")===-1&&L.indexOf("//")!==0){let H=e.protocol+"//"+e.host;if(L.indexOf("/")===0)H+=L;else{const x=e.pathname.split("/");x.pop();const P=x.join("/");H+=P+"/"+L}w.push(H)}else if(L.indexOf("//")===0){const H=e.protocol+L;w.push(H)}else w.push(L)}}return w}function i(..._){const w=t.getElementsByTagName("meta");for(let S=0;S<w.length;S++){const m=w[S],R=["itemprop","property","name"].map(L=>m.getAttribute(L)).filter(L=>L?_.includes(L):!1);if(R.length&&R){const L=m.getAttribute("content");if(L)return L}}return""}function n(){let _=i("name","og:site_name","og:title","twitter:title");return _||(_=t.title),_}function s(){return i("description","og:description","twitter:description","keywords")}const o=n(),c=s(),l=e.origin,h=r();return{description:c,url:l,icons:h,name:o}}Po=fn.getWindowMetadata=Fd;var Cr={},$d=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),To="%[a-f0-9]{2}",Co=new RegExp("("+To+")|([^%]+?)","gi"),No=new RegExp("("+To+")+","gi");function dn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],dn(r),dn(i))}function Ud(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(Co)||[],r=1;r<e.length;r++)t=dn(e,r).join(""),e=t.match(Co)||[];return t}}function Md(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=No.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=Ud(r[0]);i!==r[0]&&(e[r[0]]=i)}r=No.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),s=0;s<n.length;s++){var o=n[s];t=t.replace(new RegExp(o,"g"),e[o])}return t}var jd=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Md(t)}},Bd=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},Hd=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var o=i[s],c=t[o];(n?e.indexOf(o)!==-1:e(o,c,t))&&(r[o]=c)}return r};(function(t){const e=$d,r=jd,i=Bd,n=Hd,s=x=>x==null,o=Symbol("encodeFragmentIdentifier");function c(x){switch(x.arrayFormat){case"index":return P=>(y,D)=>{const E=y.length;return D===void 0||x.skipNull&&D===null||x.skipEmptyString&&D===""?y:D===null?[...y,[f(P,x),"[",E,"]"].join("")]:[...y,[f(P,x),"[",f(E,x),"]=",f(D,x)].join("")]};case"bracket":return P=>(y,D)=>D===void 0||x.skipNull&&D===null||x.skipEmptyString&&D===""?y:D===null?[...y,[f(P,x),"[]"].join("")]:[...y,[f(P,x),"[]=",f(D,x)].join("")];case"colon-list-separator":return P=>(y,D)=>D===void 0||x.skipNull&&D===null||x.skipEmptyString&&D===""?y:D===null?[...y,[f(P,x),":list="].join("")]:[...y,[f(P,x),":list=",f(D,x)].join("")];case"comma":case"separator":case"bracket-separator":{const P=x.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(D,E)=>E===void 0||x.skipNull&&E===null||x.skipEmptyString&&E===""?D:(E=E===null?"":E,D.length===0?[[f(y,x),P,f(E,x)].join("")]:[[D,f(E,x)].join(x.arrayFormatSeparator)])}default:return P=>(y,D)=>D===void 0||x.skipNull&&D===null||x.skipEmptyString&&D===""?y:D===null?[...y,f(P,x)]:[...y,[f(P,x),"=",f(D,x)].join("")]}}function l(x){let P;switch(x.arrayFormat){case"index":return(y,D,E)=>{if(P=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!P){E[y]=D;return}E[y]===void 0&&(E[y]={}),E[y][P[1]]=D};case"bracket":return(y,D,E)=>{if(P=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!P){E[y]=D;return}if(E[y]===void 0){E[y]=[D];return}E[y]=[].concat(E[y],D)};case"colon-list-separator":return(y,D,E)=>{if(P=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!P){E[y]=D;return}if(E[y]===void 0){E[y]=[D];return}E[y]=[].concat(E[y],D)};case"comma":case"separator":return(y,D,E)=>{const a=typeof D=="string"&&D.includes(x.arrayFormatSeparator),d=typeof D=="string"&&!a&&_(D,x).includes(x.arrayFormatSeparator);D=d?_(D,x):D;const M=a||d?D.split(x.arrayFormatSeparator).map(q=>_(q,x)):D===null?D:_(D,x);E[y]=M};case"bracket-separator":return(y,D,E)=>{const a=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!a){E[y]=D&&_(D,x);return}const d=D===null?[]:D.split(x.arrayFormatSeparator).map(M=>_(M,x));if(E[y]===void 0){E[y]=d;return}E[y]=[].concat(E[y],d)};default:return(y,D,E)=>{if(E[y]===void 0){E[y]=D;return}E[y]=[].concat(E[y],D)}}}function h(x){if(typeof x!="string"||x.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function f(x,P){return P.encode?P.strict?e(x):encodeURIComponent(x):x}function _(x,P){return P.decode?r(x):x}function w(x){return Array.isArray(x)?x.sort():typeof x=="object"?w(Object.keys(x)).sort((P,y)=>Number(P)-Number(y)).map(P=>x[P]):x}function S(x){const P=x.indexOf("#");return P!==-1&&(x=x.slice(0,P)),x}function m(x){let P="";const y=x.indexOf("#");return y!==-1&&(P=x.slice(y)),P}function R(x){x=S(x);const P=x.indexOf("?");return P===-1?"":x.slice(P+1)}function L(x,P){return P.parseNumbers&&!Number.isNaN(Number(x))&&typeof x=="string"&&x.trim()!==""?x=Number(x):P.parseBooleans&&x!==null&&(x.toLowerCase()==="true"||x.toLowerCase()==="false")&&(x=x.toLowerCase()==="true"),x}function H(x,P){P=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},P),h(P.arrayFormatSeparator);const y=l(P),D=Object.create(null);if(typeof x!="string"||(x=x.trim().replace(/^[?#&]/,""),!x))return D;for(const E of x.split("&")){if(E==="")continue;let[a,d]=i(P.decode?E.replace(/\+/g," "):E,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(P.arrayFormat)?d:_(d,P),y(_(a,P),d,D)}for(const E of Object.keys(D)){const a=D[E];if(typeof a=="object"&&a!==null)for(const d of Object.keys(a))a[d]=L(a[d],P);else D[E]=L(a,P)}return P.sort===!1?D:(P.sort===!0?Object.keys(D).sort():Object.keys(D).sort(P.sort)).reduce((E,a)=>{const d=D[a];return Boolean(d)&&typeof d=="object"&&!Array.isArray(d)?E[a]=w(d):E[a]=d,E},Object.create(null))}t.extract=R,t.parse=H,t.stringify=(x,P)=>{if(!x)return"";P=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},P),h(P.arrayFormatSeparator);const y=d=>P.skipNull&&s(x[d])||P.skipEmptyString&&x[d]==="",D=c(P),E={};for(const d of Object.keys(x))y(d)||(E[d]=x[d]);const a=Object.keys(E);return P.sort!==!1&&a.sort(P.sort),a.map(d=>{const M=x[d];return M===void 0?"":M===null?f(d,P):Array.isArray(M)?M.length===0&&P.arrayFormat==="bracket-separator"?f(d,P)+"[]":M.reduce(D(d),[]).join("&"):f(d,P)+"="+f(M,P)}).filter(d=>d.length>0).join("&")},t.parseUrl=(x,P)=>{P=Object.assign({decode:!0},P);const[y,D]=i(x,"#");return Object.assign({url:y.split("?")[0]||"",query:H(R(x),P)},P&&P.parseFragmentIdentifier&&D?{fragmentIdentifier:_(D,P)}:{})},t.stringifyUrl=(x,P)=>{P=Object.assign({encode:!0,strict:!0,[o]:!0},P);const y=S(x.url).split("?")[0]||"",D=t.extract(x.url),E=t.parse(D,{sort:!1}),a=Object.assign(E,x.query);let d=t.stringify(a,P);d&&(d=`?${d}`);let M=m(x.url);return x.fragmentIdentifier&&(M=`#${P[o]?f(x.fragmentIdentifier,P):x.fragmentIdentifier}`),`${y}${d}${M}`},t.pick=(x,P,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[o]:!1},y);const{url:D,query:E,fragmentIdentifier:a}=t.parseUrl(x,y);return t.stringifyUrl({url:D,query:n(E,P),fragmentIdentifier:a},y)},t.exclude=(x,P,y)=>{const D=Array.isArray(P)?E=>!P.includes(E):(E,a)=>!P(E,a);return t.pick(x,D,y)}})(Cr);const qd={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Ro(t,e){return t.includes(":")?[t]:e.chains||[]}const Lo="base10",lt="base16",pn="base64pad",gn="utf8",Fo=0,Yt=1,zd=0,$o=1,yn=12,_n=32;function Kd(){const t=hn.generateKeyPair();return{privateKey:ut(t.secretKey,lt),publicKey:ut(t.publicKey,lt)}}function bn(){const t=ar.randomBytes(_n);return ut(t,lt)}function Vd(t,e){const r=hn.sharedKey(ht(t,lt),ht(e,lt)),i=new ld(ci.SHA256,r).expand(_n);return ut(i,lt)}function Gd(t){const e=ci.hash(ht(t,lt));return ut(e,lt)}function ui(t){const e=ci.hash(ht(t,gn));return ut(e,lt)}function kd(t){return ht(`${t}`,Lo)}function Nr(t){return Number(ut(t,Lo))}function Wd(t){const e=kd(typeof t.type<"u"?t.type:Fo);if(Nr(e)===Yt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ht(t.senderPublicKey,lt):void 0,i=typeof t.iv<"u"?ht(t.iv,lt):ar.randomBytes(yn),n=new an.ChaCha20Poly1305(ht(t.symKey,lt)).seal(i,ht(t.message,gn));return Jd({type:e,sealed:n,iv:i,senderPublicKey:r})}function Yd(t){const e=new an.ChaCha20Poly1305(ht(t.symKey,lt)),{sealed:r,iv:i}=vn(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return ut(n,gn)}function Jd(t){if(Nr(t.type)===Yt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ut(rn([t.type,t.senderPublicKey,t.iv,t.sealed]),pn)}return ut(rn([t.type,t.iv,t.sealed]),pn)}function vn(t){const e=ht(t,pn),r=e.slice(zd,$o),i=$o;if(Nr(r)===Yt){const c=i+_n,l=c+yn,h=e.slice(i,c),f=e.slice(c,l),_=e.slice(l);return{type:r,sealed:_,iv:f,senderPublicKey:h}}const n=i+yn,s=e.slice(i,n),o=e.slice(n);return{type:r,sealed:o,iv:s}}function Xd(t,e){const r=vn(t);return Uo({type:Nr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ut(r.senderPublicKey,lt):void 0,receiverPublicKey:e?.receiverPublicKey})}function Uo(t){const e=t?.type||Fo;if(e===Yt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Mo(t){return t.type===Yt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Zd=Object.defineProperty,jo=Object.getOwnPropertySymbols,Qd=Object.prototype.hasOwnProperty,ep=Object.prototype.propertyIsEnumerable,Bo=(t,e,r)=>e in t?Zd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ho=(t,e)=>{for(var r in e||(e={}))Qd.call(e,r)&&Bo(t,r,e[r]);if(jo)for(var r of jo(e))ep.call(e,r)&&Bo(t,r,e[r]);return t};const tp="ReactNative",Rr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},rp="js";function qo(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function ip(){return!Oo()&&!!ln()&&navigator.product===tp}function np(){return!qo()&&!!ln()}function sp(){return ip()?Rr.reactNative:qo()?Rr.node:np()?Rr.browser:Rr.unknown}function op(t,e){let r=Cr.parse(t);return r=Ho(Ho({},r),e),t=Cr.stringify(r),t}function ap(){return Po()||{name:"",description:"",url:"",icons:[""]}}function cp(){const t=wd();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function up(){var t;const e=sp();return e===Rr.browser?[e,((t=Io())==null?void 0:t.host)||"unknown"].join(":"):e}function hp(t,e,r){const i=cp(),n=up();return[[t,e].join("-"),[rp,r].join("-"),i,n].join("/")}function lp({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:o}){const c=r.split("?"),l=hp(t,e,i),h={auth:n,ua:l,projectId:s,useOnCloseEvent:o||void 0},f=op(c[1]||"",h);return c[0]+"?"+f}function Jt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function zo(t){return Object.fromEntries(t.entries())}function Ko(t){return new Map(Object.entries(t))}function Xt(t=Z.FIVE_MINUTES,e){const r=Z.toMiliseconds(t||Z.FIVE_MINUTES);let i,n,s;return{resolve:o=>{s&&i&&(clearTimeout(s),i(o))},reject:o=>{s&&n&&(clearTimeout(s),n(o))},done:()=>new Promise((o,c)=>{s=setTimeout(()=>{c(new Error(e))},r),i=o,n=c})}}function wn(t,e){return new Promise(async(r,i)=>{const n=setTimeout(()=>i(),e),s=await t;clearTimeout(n),r(s)})}function Vo(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function fp(t){return Vo("topic",t)}function dp(t){return Vo("id",t)}function Go(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function xt(t,e){return Z.fromMiliseconds((e||Date.now())+Z.toMiliseconds(t))}function Ft(t){return Date.now()>=Z.toMiliseconds(t)}function Le(t,e){return`${t}${e?`:${e}`:""}`}const pp="irn";function mn(t){return t?.relay||{protocol:pp}}function hi(t){const e=qd[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var gp=Object.defineProperty,ko=Object.getOwnPropertySymbols,yp=Object.prototype.hasOwnProperty,_p=Object.prototype.propertyIsEnumerable,Wo=(t,e,r)=>e in t?gp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bp=(t,e)=>{for(var r in e||(e={}))yp.call(e,r)&&Wo(t,r,e[r]);if(ko)for(var r of ko(e))_p.call(e,r)&&Wo(t,r,e[r]);return t};function vp(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),o=t[n];r[s]=o}}),r}function wp(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=Cr.parse(s);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:o.symKey,relay:vp(o)}}function mp(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function Ep(t){return`${t.protocol}:${t.topic}@${t.version}?`+Cr.stringify(bp({symKey:t.symKey},mp(t.relay)))}function ur(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function Dp(t){const e=[];return Object.values(t).forEach(r=>{e.push(...ur(r.accounts))}),e}function Sp(t,e){const r=[];return Object.values(t).forEach(i=>{ur(i.accounts).includes(e)&&r.push(...i.methods)}),r}function xp(t,e){const r=[];return Object.values(t).forEach(i=>{ur(i.accounts).includes(e)&&r.push(...i.events)}),r}function Op(t,e){const r=li(t,e);if(r)throw new Error(r.message);const i={};for(const[n,s]of Object.entries(t))i[n]={methods:s.methods,events:s.events,chains:s.accounts.map(o=>`${o.split(":")[0]}:${o.split(":")[1]}`)};return i}const Ip={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Pp={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function V(t,e){const{message:r,code:i}=Pp[t];return{message:e?`${r} ${e}`:r,code:i}}function $e(t,e){const{message:r,code:i}=Ip[t];return{message:e?`${r} ${e}`:r,code:i}}function Lr(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Fr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function at(t){return typeof t>"u"}function Ke(t,e){return e&&at(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function En(t,e){return e&&at(t)?!0:typeof t=="number"&&!isNaN(t)}function Ap(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return Jt(n,i)?(i.forEach(o=>{const{accounts:c,methods:l,events:h}=t.namespaces[o],f=ur(c),_=r[o];(!Jt(Ro(o,_),f)||!Jt(_.methods,l)||!Jt(_.events,h))&&(s=!1)}),s):!1}function Dn(t){return Ke(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Tp(t){if(Ke(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Dn(r)}}return!1}function Cp(t){if(Ke(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Np(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Rp(t){return t?.topic}function Lp(t,e){let r=null;return Ke(t?.publicKey,!1)||(r=V("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Yo(t){let e=!0;return Lr(t)?t.length&&(e=t.every(r=>Ke(r,!1))):e=!1,e}function Fp(t,e,r){let i=null;return Lr(e)?e.forEach(n=>{i||(!Dn(n)||!n.includes(t))&&(i=$e("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=$e("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function $p(t,e){let r=null;return Object.entries(t).forEach(([i,n])=>{if(r)return;const s=Fp(i,Ro(i,n),`${e} requiredNamespace`);s&&(r=s)}),r}function Up(t,e){let r=null;return Lr(t)?t.forEach(i=>{r||Tp(i)||(r=$e("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=$e("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Mp(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Up(i?.accounts,`${e} namespace`);n&&(r=n)}),r}function jp(t,e){let r=null;return Yo(t?.methods)?Yo(t?.events)||(r=$e("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=$e("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Jo(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=jp(i,`${e}, namespace`);n&&(r=n)}),r}function Bp(t,e,r){let i=null;if(t&&Fr(t)){const n=Jo(t,e);n&&(i=n);const s=$p(t,e);s&&(i=s)}else i=V("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function li(t,e){let r=null;if(t&&Fr(t)){const i=Jo(t,e);i&&(r=i);const n=Mp(t,e);n&&(r=n)}else r=V("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Xo(t){return Ke(t.protocol,!0)}function Hp(t,e){let r=!1;return e&&!t?r=!0:t&&Lr(t)&&t.length&&t.forEach(i=>{r=Xo(i)}),r}function qp(t){return typeof t=="number"}function ft(t){return typeof t<"u"&&typeof t!==null}function zp(t){return!(!t||typeof t!="object"||!t.code||!En(t.code,!1)||!t.message||!Ke(t.message,!1))}function Kp(t){return!(at(t)||!Ke(t.method,!1))}function Vp(t){return!(at(t)||at(t.result)&&at(t.error)||!En(t.id,!1)||!Ke(t.jsonrpc,!1))}function Gp(t){return!(at(t)||!Ke(t.name,!1))}function Zo(t,e){return!(!Dn(e)||!Dp(t).includes(e))}function kp(t,e,r){return Ke(r,!1)?Sp(t,e).includes(r):!1}function Wp(t,e,r){return Ke(r,!1)?xp(t,e).includes(r):!1}function Qo(t,e,r){let i=null;const n=Yp(t),s=Jp(e),o=Object.keys(n),c=Object.keys(s),l=ea(Object.keys(t)),h=ea(Object.keys(e)),f=l.filter(_=>!h.includes(_));return f.length&&(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${f.toString()}
      Received: ${Object.keys(e).toString()}`)),Jt(o,c)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${c.toString()}`)),Object.keys(e).forEach(_=>{if(!_.includes(":")||i)return;const w=ur(e[_].accounts);w.includes(_)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${_}
        Required: ${_}
        Approved: ${w.toString()}`))}),o.forEach(_=>{i||(Jt(n[_].methods,s[_].methods)?Jt(n[_].events,s[_].events)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${_}`)):i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${_}`))}),i}function Yp(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function ea(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Jp(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const i=ur(t[r].accounts);i?.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function Xp(t,e){return En(t,!1)&&t<=e.max&&t>=e.min}const Zp="PARSE_ERROR",Qp="INVALID_REQUEST",eg="METHOD_NOT_FOUND",tg="INVALID_PARAMS",ta="INTERNAL_ERROR",Sn="SERVER_ERROR",rg=[-32700,-32600,-32601,-32602,-32603],$r={[Zp]:{code:-32700,message:"Parse error"},[Qp]:{code:-32600,message:"Invalid Request"},[eg]:{code:-32601,message:"Method not found"},[tg]:{code:-32602,message:"Invalid params"},[ta]:{code:-32603,message:"Internal error"},[Sn]:{code:-32e3,message:"Server error"}},ra=Sn;function ig(t){return rg.includes(t)}function ia(t){return Object.keys($r).includes(t)?$r[t]:$r[ra]}function ng(t){const e=Object.values($r).find(r=>r.code===t);return e||$r[ra]}function na(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var sa={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var xn=function(t,e){return xn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},xn(t,e)};function sg(t,e){xn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var On=function(){return On=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},On.apply(this,arguments)};function og(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function ag(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function cg(t,e){return function(r,i){e(r,i,t)}}function ug(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function hg(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(f){try{h(i.next(f))}catch(_){o(_)}}function l(f){try{h(i.throw(f))}catch(_){o(_)}}function h(f){f.done?s(f.value):n(f.value).then(c,l)}h((i=i.apply(t,e||[])).next())})}function lg(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(f){return l([h,f])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function fg(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function dg(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function In(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function oa(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function pg(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(oa(arguments[e]));return t}function gg(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,c=s.length;o<c;o++,n++)i[n]=s[o];return i}function Ur(t){return this instanceof Ur?(this.v=t,this):new Ur(t)}function yg(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(w){i[w]&&(n[w]=function(S){return new Promise(function(m,R){s.push([w,S,m,R])>1||c(w,S)})})}function c(w,S){try{l(i[w](S))}catch(m){_(s[0][3],m)}}function l(w){w.value instanceof Ur?Promise.resolve(w.value.v).then(h,f):_(s[0][2],w)}function h(w){c("next",w)}function f(w){c("throw",w)}function _(w,S){w(S),s.shift(),s.length&&c(s[0][0],s[0][1])}}function _g(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:Ur(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function bg(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof In=="function"?In(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(c,l){o=t[s](o),n(c,l,o.done,o.value)})}}function n(s,o,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},o)}}function vg(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function wg(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function mg(t){return t&&t.__esModule?t:{default:t}}function Eg(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Dg(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Sg=Object.freeze({__proto__:null,__extends:sg,get __assign(){return On},__rest:og,__decorate:ag,__param:cg,__metadata:ug,__awaiter:hg,__generator:lg,__createBinding:fg,__exportStar:dg,__values:In,__read:oa,__spread:pg,__spreadArrays:gg,__await:Ur,__asyncGenerator:yg,__asyncDelegator:_g,__asyncValues:bg,__makeTemplateObject:vg,__importStar:wg,__importDefault:mg,__classPrivateFieldGet:Eg,__classPrivateFieldSet:Dg}),xg=qt(Sg),At={},aa;function Og(){if(aa)return At;aa=1,Object.defineProperty(At,"__esModule",{value:!0}),At.isBrowserCryptoAvailable=At.getSubtleCrypto=At.getBrowerCrypto=void 0;function t(){return ze?.crypto||ze?.msCrypto||{}}At.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}At.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return At.isBrowserCryptoAvailable=r,At}var Tt={},ca;function Ig(){if(ca)return Tt;ca=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.isBrowser=Tt.isNode=Tt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Tt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Tt.isNode=e;function r(){return!t()&&!e()}return Tt.isBrowser=r,Tt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=xg;e.__exportStar(Og(),t),e.__exportStar(Ig(),t)})(sa);function Pg(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function fi(t,e,r){return{id:r||Pg(),jsonrpc:"2.0",method:t,params:e}}function Pn(t,e){return{id:t,jsonrpc:"2.0",result:e}}function di(t,e,r){return{id:t,jsonrpc:"2.0",error:Ag(e,r)}}function Ag(t,e){return typeof t>"u"?ia(ta):(typeof t=="string"&&(t=Object.assign(Object.assign({},ia(Sn)),{message:t})),typeof e<"u"&&(t.data=e),ig(t.code)&&(t=ng(t.code)),t)}class Tg{}class Cg extends Tg{constructor(){super()}}class Ng extends Cg{constructor(e){super()}}const Rg="^https?:",Lg="^wss?:";function Fg(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function ua(t,e){const r=Fg(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function ha(t){return ua(t,Rg)}function la(t){return ua(t,Lg)}function $g(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function fa(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function An(t){return fa(t)&&"method"in t}function Tn(t){return fa(t)&&(Ct(t)||wt(t))}function Ct(t){return"result"in t}function wt(t){return"error"in t}class Mr extends Ng{constructor(e){super(e),this.events=new it.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(fi(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{wt(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Tn(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}const da=10,Ug=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),Mg=()=>typeof window<"u",jg=Ug();class Bg{constructor(e){if(this.url=e,this.events=new it.exports.EventEmitter,this.registering=!1,!la(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Pr(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!la(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=sa.isReactNative()?void 0:{rejectUnauthorized:!$g(e)},s=new jg(e,[],n);Mg()?s.onerror=o=>{const c=o;i(this.emitError(c.error))}:s.on("error",o=>{i(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Ji(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=di(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return na(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>da&&this.events.setMaxListeners(da)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Cn={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,o=9007199254740991,c="[object Arguments]",l="[object Array]",h="[object AsyncFunction]",f="[object Boolean]",_="[object Date]",w="[object Error]",S="[object Function]",m="[object GeneratorFunction]",R="[object Map]",L="[object Number]",H="[object Null]",x="[object Object]",P="[object Promise]",y="[object Proxy]",D="[object RegExp]",E="[object Set]",a="[object String]",d="[object Symbol]",M="[object Undefined]",q="[object WeakMap]",G="[object ArrayBuffer]",J="[object DataView]",X="[object Float32Array]",g="[object Float64Array]",b="[object Int8Array]",$="[object Int16Array]",U="[object Int32Array]",N="[object Uint8Array]",C="[object Uint8ClampedArray]",j="[object Uint16Array]",B="[object Uint32Array]",Q=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,ee=/^(?:0|[1-9]\d*)$/,Y={};Y[X]=Y[g]=Y[b]=Y[$]=Y[U]=Y[N]=Y[C]=Y[j]=Y[B]=!0,Y[c]=Y[l]=Y[G]=Y[f]=Y[J]=Y[_]=Y[w]=Y[S]=Y[R]=Y[L]=Y[x]=Y[D]=Y[E]=Y[a]=Y[q]=!1;var ae=typeof ze=="object"&&ze&&ze.Object===Object&&ze,T=typeof self=="object"&&self&&self.Object===Object&&self,A=ae||T||Function("return this")(),O=e&&!e.nodeType&&e,u=O&&!0&&t&&!t.nodeType&&t,v=u&&u.exports===O,K=v&&ae.process,k=function(){try{return K&&K.binding&&K.binding("util")}catch{}}(),le=k&&k.isTypedArray;function _e(p,I){for(var F=-1,W=p==null?0:p.length,Ie=0,ne=[];++F<W;){var Re=p[F];I(Re,F,p)&&(ne[Ie++]=Re)}return ne}function de(p,I){for(var F=-1,W=I.length,Ie=p.length;++F<W;)p[Ie+F]=I[F];return p}function we(p,I){for(var F=-1,W=p==null?0:p.length;++F<W;)if(I(p[F],F,p))return!0;return!1}function Fe(p,I){for(var F=-1,W=Array(p);++F<p;)W[F]=I(F);return W}function Te(p){return function(I){return p(I)}}function ye(p,I){return p.has(I)}function pe(p,I){return p?.[I]}function fe(p){var I=-1,F=Array(p.size);return p.forEach(function(W,Ie){F[++I]=[Ie,W]}),F}function ue(p,I){return function(F){return p(I(F))}}function ce(p){var I=-1,F=Array(p.size);return p.forEach(function(W){F[++I]=W}),F}var oe=Array.prototype,se=Function.prototype,te=Object.prototype,he=A["__core-js_shared__"],ge=se.toString,ie=te.hasOwnProperty,be=function(){var p=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),ve=te.toString,Ee=RegExp("^"+ge.call(ie).replace(Q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=v?A.Buffer:void 0,me=A.Symbol,mt=A.Uint8Array,Pt=te.propertyIsEnumerable,Ut=oe.splice,pt=me?me.toStringTag:void 0,Zt=Object.getOwnPropertySymbols,Kr=De?De.isBuffer:void 0,Ei=ue(Object.keys,Object),Ue=lr(A,"DataView"),Ce=lr(A,"Map"),Me=lr(A,"Promise"),je=lr(A,"Set"),Be=lr(A,"WeakMap"),Ne=lr(Object,"create"),Ge=er(Ue),ke=er(Ce),We=er(Me),Ye=er(je),Je=er(Be),qe=me?me.prototype:void 0,He=qe?qe.valueOf:void 0;function Pe(p){var I=-1,F=p==null?0:p.length;for(this.clear();++I<F;){var W=p[I];this.set(W[0],W[1])}}function Xe(){this.__data__=Ne?Ne(null):{},this.size=0}function Ze(p){var I=this.has(p)&&delete this.__data__[p];return this.size-=I?1:0,I}function B_(p){var I=this.__data__;if(Ne){var F=I[p];return F===i?void 0:F}return ie.call(I,p)?I[p]:void 0}function H_(p){var I=this.__data__;return Ne?I[p]!==void 0:ie.call(I,p)}function q_(p,I){var F=this.__data__;return this.size+=this.has(p)?0:1,F[p]=Ne&&I===void 0?i:I,this}Pe.prototype.clear=Xe,Pe.prototype.delete=Ze,Pe.prototype.get=B_,Pe.prototype.has=H_,Pe.prototype.set=q_;function Nt(p){var I=-1,F=p==null?0:p.length;for(this.clear();++I<F;){var W=p[I];this.set(W[0],W[1])}}function z_(){this.__data__=[],this.size=0}function K_(p){var I=this.__data__,F=Si(I,p);if(F<0)return!1;var W=I.length-1;return F==W?I.pop():Ut.call(I,F,1),--this.size,!0}function V_(p){var I=this.__data__,F=Si(I,p);return F<0?void 0:I[F][1]}function G_(p){return Si(this.__data__,p)>-1}function k_(p,I){var F=this.__data__,W=Si(F,p);return W<0?(++this.size,F.push([p,I])):F[W][1]=I,this}Nt.prototype.clear=z_,Nt.prototype.delete=K_,Nt.prototype.get=V_,Nt.prototype.has=G_,Nt.prototype.set=k_;function Qt(p){var I=-1,F=p==null?0:p.length;for(this.clear();++I<F;){var W=p[I];this.set(W[0],W[1])}}function W_(){this.size=0,this.__data__={hash:new Pe,map:new(Ce||Nt),string:new Pe}}function Y_(p){var I=xi(this,p).delete(p);return this.size-=I?1:0,I}function J_(p){return xi(this,p).get(p)}function X_(p){return xi(this,p).has(p)}function Z_(p,I){var F=xi(this,p),W=F.size;return F.set(p,I),this.size+=F.size==W?0:1,this}Qt.prototype.clear=W_,Qt.prototype.delete=Y_,Qt.prototype.get=J_,Qt.prototype.has=X_,Qt.prototype.set=Z_;function Di(p){var I=-1,F=p==null?0:p.length;for(this.__data__=new Qt;++I<F;)this.add(p[I])}function Q_(p){return this.__data__.set(p,i),this}function eb(p){return this.__data__.has(p)}Di.prototype.add=Di.prototype.push=Q_,Di.prototype.has=eb;function Mt(p){var I=this.__data__=new Nt(p);this.size=I.size}function tb(){this.__data__=new Nt,this.size=0}function rb(p){var I=this.__data__,F=I.delete(p);return this.size=I.size,F}function ib(p){return this.__data__.get(p)}function nb(p){return this.__data__.has(p)}function sb(p,I){var F=this.__data__;if(F instanceof Nt){var W=F.__data__;if(!Ce||W.length<r-1)return W.push([p,I]),this.size=++F.size,this;F=this.__data__=new Qt(W)}return F.set(p,I),this.size=F.size,this}Mt.prototype.clear=tb,Mt.prototype.delete=rb,Mt.prototype.get=ib,Mt.prototype.has=nb,Mt.prototype.set=sb;function ob(p,I){var F=Oi(p),W=!F&&mb(p),Ie=!F&&!W&&Gn(p),ne=!F&&!W&&!Ie&&pc(p),Re=F||W||Ie||ne,Qe=Re?Fe(p.length,String):[],rt=Qe.length;for(var Ae in p)(I||ie.call(p,Ae))&&!(Re&&(Ae=="length"||Ie&&(Ae=="offset"||Ae=="parent")||ne&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||yb(Ae,rt)))&&Qe.push(Ae);return Qe}function Si(p,I){for(var F=p.length;F--;)if(hc(p[F][0],I))return F;return-1}function ab(p,I,F){var W=I(p);return Oi(p)?W:de(W,F(p))}function Vr(p){return p==null?p===void 0?M:H:pt&&pt in Object(p)?pb(p):wb(p)}function oc(p){return Gr(p)&&Vr(p)==c}function ac(p,I,F,W,Ie){return p===I?!0:p==null||I==null||!Gr(p)&&!Gr(I)?p!==p&&I!==I:cb(p,I,F,W,ac,Ie)}function cb(p,I,F,W,Ie,ne){var Re=Oi(p),Qe=Oi(I),rt=Re?l:jt(p),Ae=Qe?l:jt(I);rt=rt==c?x:rt,Ae=Ae==c?x:Ae;var gt=rt==x,Et=Ae==x,st=rt==Ae;if(st&&Gn(p)){if(!Gn(I))return!1;Re=!0,gt=!1}if(st&&!gt)return ne||(ne=new Mt),Re||pc(p)?cc(p,I,F,W,Ie,ne):fb(p,I,rt,F,W,Ie,ne);if(!(F&n)){var bt=gt&&ie.call(p,"__wrapped__"),vt=Et&&ie.call(I,"__wrapped__");if(bt||vt){var Bt=bt?p.value():p,Rt=vt?I.value():I;return ne||(ne=new Mt),Ie(Bt,Rt,F,W,ne)}}return st?(ne||(ne=new Mt),db(p,I,F,W,Ie,ne)):!1}function ub(p){if(!dc(p)||bb(p))return!1;var I=lc(p)?Ee:z;return I.test(er(p))}function hb(p){return Gr(p)&&fc(p.length)&&!!Y[Vr(p)]}function lb(p){if(!vb(p))return Ei(p);var I=[];for(var F in Object(p))ie.call(p,F)&&F!="constructor"&&I.push(F);return I}function cc(p,I,F,W,Ie,ne){var Re=F&n,Qe=p.length,rt=I.length;if(Qe!=rt&&!(Re&&rt>Qe))return!1;var Ae=ne.get(p);if(Ae&&ne.get(I))return Ae==I;var gt=-1,Et=!0,st=F&s?new Di:void 0;for(ne.set(p,I),ne.set(I,p);++gt<Qe;){var bt=p[gt],vt=I[gt];if(W)var Bt=Re?W(vt,bt,gt,I,p,ne):W(bt,vt,gt,p,I,ne);if(Bt!==void 0){if(Bt)continue;Et=!1;break}if(st){if(!we(I,function(Rt,tr){if(!ye(st,tr)&&(bt===Rt||Ie(bt,Rt,F,W,ne)))return st.push(tr)})){Et=!1;break}}else if(!(bt===vt||Ie(bt,vt,F,W,ne))){Et=!1;break}}return ne.delete(p),ne.delete(I),Et}function fb(p,I,F,W,Ie,ne,Re){switch(F){case J:if(p.byteLength!=I.byteLength||p.byteOffset!=I.byteOffset)return!1;p=p.buffer,I=I.buffer;case G:return!(p.byteLength!=I.byteLength||!ne(new mt(p),new mt(I)));case f:case _:case L:return hc(+p,+I);case w:return p.name==I.name&&p.message==I.message;case D:case a:return p==I+"";case R:var Qe=fe;case E:var rt=W&n;if(Qe||(Qe=ce),p.size!=I.size&&!rt)return!1;var Ae=Re.get(p);if(Ae)return Ae==I;W|=s,Re.set(p,I);var gt=cc(Qe(p),Qe(I),W,Ie,ne,Re);return Re.delete(p),gt;case d:if(He)return He.call(p)==He.call(I)}return!1}function db(p,I,F,W,Ie,ne){var Re=F&n,Qe=uc(p),rt=Qe.length,Ae=uc(I),gt=Ae.length;if(rt!=gt&&!Re)return!1;for(var Et=rt;Et--;){var st=Qe[Et];if(!(Re?st in I:ie.call(I,st)))return!1}var bt=ne.get(p);if(bt&&ne.get(I))return bt==I;var vt=!0;ne.set(p,I),ne.set(I,p);for(var Bt=Re;++Et<rt;){st=Qe[Et];var Rt=p[st],tr=I[st];if(W)var gc=Re?W(tr,Rt,st,I,p,ne):W(Rt,tr,st,p,I,ne);if(!(gc===void 0?Rt===tr||Ie(Rt,tr,F,W,ne):gc)){vt=!1;break}Bt||(Bt=st=="constructor")}if(vt&&!Bt){var Ii=p.constructor,Pi=I.constructor;Ii!=Pi&&"constructor"in p&&"constructor"in I&&!(typeof Ii=="function"&&Ii instanceof Ii&&typeof Pi=="function"&&Pi instanceof Pi)&&(vt=!1)}return ne.delete(p),ne.delete(I),vt}function uc(p){return ab(p,Sb,gb)}function xi(p,I){var F=p.__data__;return _b(I)?F[typeof I=="string"?"string":"hash"]:F.map}function lr(p,I){var F=pe(p,I);return ub(F)?F:void 0}function pb(p){var I=ie.call(p,pt),F=p[pt];try{p[pt]=void 0;var W=!0}catch{}var Ie=ve.call(p);return W&&(I?p[pt]=F:delete p[pt]),Ie}var gb=Zt?function(p){return p==null?[]:(p=Object(p),_e(Zt(p),function(I){return Pt.call(p,I)}))}:xb,jt=Vr;(Ue&&jt(new Ue(new ArrayBuffer(1)))!=J||Ce&&jt(new Ce)!=R||Me&&jt(Me.resolve())!=P||je&&jt(new je)!=E||Be&&jt(new Be)!=q)&&(jt=function(p){var I=Vr(p),F=I==x?p.constructor:void 0,W=F?er(F):"";if(W)switch(W){case Ge:return J;case ke:return R;case We:return P;case Ye:return E;case Je:return q}return I});function yb(p,I){return I=I??o,!!I&&(typeof p=="number"||ee.test(p))&&p>-1&&p%1==0&&p<I}function _b(p){var I=typeof p;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?p!=="__proto__":p===null}function bb(p){return!!be&&be in p}function vb(p){var I=p&&p.constructor,F=typeof I=="function"&&I.prototype||te;return p===F}function wb(p){return ve.call(p)}function er(p){if(p!=null){try{return ge.call(p)}catch{}try{return p+""}catch{}}return""}function hc(p,I){return p===I||p!==p&&I!==I}var mb=oc(function(){return arguments}())?oc:function(p){return Gr(p)&&ie.call(p,"callee")&&!Pt.call(p,"callee")},Oi=Array.isArray;function Eb(p){return p!=null&&fc(p.length)&&!lc(p)}var Gn=Kr||Ob;function Db(p,I){return ac(p,I)}function lc(p){if(!dc(p))return!1;var I=Vr(p);return I==S||I==m||I==h||I==y}function fc(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=o}function dc(p){var I=typeof p;return p!=null&&(I=="object"||I=="function")}function Gr(p){return p!=null&&typeof p=="object"}var pc=le?Te(le):hb;function Sb(p){return Eb(p)?ob(p):lb(p)}function xb(){return[]}function Ob(){return!1}t.exports=Db})(Cn,Cn.exports);var Hg=Cn.exports,qg=Object.defineProperty,pa=Object.getOwnPropertySymbols,zg=Object.prototype.hasOwnProperty,Kg=Object.prototype.propertyIsEnumerable,ga=(t,e,r)=>e in t?qg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ct=(t,e)=>{for(var r in e||(e={}))zg.call(e,r)&&ga(t,r,e[r]);if(pa)for(var r of pa(e))Kg.call(e,r)&&ga(t,r,e[r]);return t};function Vg(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var c=t.length,l=t.charAt(0),h=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function _(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var R=0,L=0,H=0,x=m.length;H!==x&&m[H]===0;)H++,R++;for(var P=(x-H)*f+1>>>0,y=new Uint8Array(P);H!==x;){for(var D=m[H],E=0,a=P-1;(D!==0||E<L)&&a!==-1;a--,E++)D+=256*y[a]>>>0,y[a]=D%c>>>0,D=D/c>>>0;if(D!==0)throw new Error("Non-zero carry");L=E,H++}for(var d=P-L;d!==P&&y[d]===0;)d++;for(var M=l.repeat(R);d<P;++d)M+=t.charAt(y[d]);return M}function w(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var R=0;if(m[R]!==" "){for(var L=0,H=0;m[R]===l;)L++,R++;for(var x=(m.length-R)*h+1>>>0,P=new Uint8Array(x);m[R];){var y=r[m.charCodeAt(R)];if(y===255)return;for(var D=0,E=x-1;(y!==0||D<H)&&E!==-1;E--,D++)y+=c*P[E]>>>0,P[E]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");H=D,R++}if(m[R]!==" "){for(var a=x-H;a!==x&&P[a]===0;)a++;for(var d=new Uint8Array(L+(x-a)),M=L;a!==x;)d[M++]=P[a++];return d}}}function S(m){var R=w(m);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:_,decodeUnsafe:w,decode:S}}var Gg=Vg,kg=Gg;const ya=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Wg=t=>new TextEncoder().encode(t),Yg=t=>new TextDecoder().decode(t);class Jg{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Xg{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return _a(this,e)}}class Zg{constructor(e){this.decoders=e}or(e){return _a(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _a=(t,e)=>new Zg(ct(ct({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class Qg{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new Jg(e,r,i),this.decoder=new Xg(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const pi=({name:t,prefix:e,encode:r,decode:i})=>new Qg(t,e,r,i),jr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=kg(r,e);return pi({prefix:t,name:e,encode:i,decode:s=>ya(n(s))})},ey=(t,e,r,i)=>{const n={};for(let f=0;f<e.length;++f)n[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let c=0,l=0,h=0;for(let f=0;f<s;++f){const _=n[t[f]];if(_===void 0)throw new SyntaxError(`Non-${i} character`);l=l<<r|_,c+=r,c>=8&&(c-=8,o[h++]=255&l>>c)}if(c>=r||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return o},ty=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,c=0;for(let l=0;l<t.length;++l)for(c=c<<8|t[l],o+=8;o>r;)o-=r,s+=e[n&c>>o];if(o&&(s+=e[n&c<<r-o]),i)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>pi({prefix:e,name:t,encode(n){return ty(n,i,r)},decode(n){return ey(n,i,r,t)}}),ry=pi({prefix:"\0",name:"identity",encode:t=>Yg(t),decode:t=>Wg(t)});var iy=Object.freeze({__proto__:null,identity:ry});const ny=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var sy=Object.freeze({__proto__:null,base2:ny});const oy=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ay=Object.freeze({__proto__:null,base8:oy});const cy=jr({prefix:"9",name:"base10",alphabet:"0123456789"});var uy=Object.freeze({__proto__:null,base10:cy});const hy=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ly=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var fy=Object.freeze({__proto__:null,base16:hy,base16upper:ly});const dy=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),py=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),gy=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),yy=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_y=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),by=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),vy=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),wy=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),my=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ey=Object.freeze({__proto__:null,base32:dy,base32upper:py,base32pad:gy,base32padupper:yy,base32hex:_y,base32hexupper:by,base32hexpad:vy,base32hexpadupper:wy,base32z:my});const Dy=jr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Sy=jr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var xy=Object.freeze({__proto__:null,base36:Dy,base36upper:Sy});const Oy=jr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Iy=jr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Py=Object.freeze({__proto__:null,base58btc:Oy,base58flickr:Iy});const Ay=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ty=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Cy=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ny=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ry=Object.freeze({__proto__:null,base64:Ay,base64pad:Ty,base64url:Cy,base64urlpad:Ny});const ba=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Ly=ba.reduce((t,e,r)=>(t[r]=e,t),[]),Fy=ba.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function $y(t){return t.reduce((e,r)=>(e+=Ly[r],e),"")}function Uy(t){const e=[];for(const r of t){const i=Fy[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const My=pi({prefix:"\u{1F680}",name:"base256emoji",encode:$y,decode:Uy});var jy=Object.freeze({__proto__:null,base256emoji:My}),By=wa,va=128,Hy=127,qy=~Hy,zy=Math.pow(2,31);function wa(t,e,r){e=e||[],r=r||0;for(var i=r;t>=zy;)e[r++]=t&255|va,t/=128;for(;t&qy;)e[r++]=t&255|va,t>>>=7;return e[r]=t|0,wa.bytes=r-i+1,e}var Ky=Nn,Vy=128,ma=127;function Nn(t,i){var r=0,i=i||0,n=0,s=i,o,c=t.length;do{if(s>=c)throw Nn.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&ma)<<n:(o&ma)*Math.pow(2,n),n+=7}while(o>=Vy);return Nn.bytes=s-i,r}var Gy=Math.pow(2,7),ky=Math.pow(2,14),Wy=Math.pow(2,21),Yy=Math.pow(2,28),Jy=Math.pow(2,35),Xy=Math.pow(2,42),Zy=Math.pow(2,49),Qy=Math.pow(2,56),e0=Math.pow(2,63),t0=function(t){return t<Gy?1:t<ky?2:t<Wy?3:t<Yy?4:t<Jy?5:t<Xy?6:t<Zy?7:t<Qy?8:t<e0?9:10},r0={encode:By,decode:Ky,encodingLength:t0},Ea=r0;const Da=(t,e,r=0)=>(Ea.encode(t,e,r),e),Sa=t=>Ea.encodingLength(t),Rn=(t,e)=>{const r=e.byteLength,i=Sa(t),n=i+Sa(r),s=new Uint8Array(n+r);return Da(t,s,0),Da(r,s,i),s.set(e,n),new i0(t,r,e,s)};class i0{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const xa=({name:t,code:e,encode:r})=>new n0(t,e,r);class n0{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Rn(this.code,r):r.then(i=>Rn(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Oa=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),s0=xa({name:"sha2-256",code:18,encode:Oa("SHA-256")}),o0=xa({name:"sha2-512",code:19,encode:Oa("SHA-512")});var a0=Object.freeze({__proto__:null,sha256:s0,sha512:o0});const Ia=0,c0="identity",Pa=ya;var u0=Object.freeze({__proto__:null,identity:{code:Ia,name:c0,encode:Pa,digest:t=>Rn(Ia,Pa(t))}});new TextEncoder,new TextDecoder;const Aa=ct(ct(ct(ct(ct(ct(ct(ct(ct(ct({},iy),sy),ay),uy),fy),Ey),xy),Py),Ry),jy);ct(ct({},a0),u0);function h0(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Ta(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Ca=Ta("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ln=Ta("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=h0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),l0=ct({utf8:Ca,"utf-8":Ca,hex:Aa.base16,latin1:Ln,ascii:Ln,binary:Ln},Aa);function f0(t,e="utf8"){const r=l0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const Na="wc",d0=2,Fn="core",$t=`${Na}@${2}:${Fn}:`,p0={name:Fn,logger:"error"},g0={database:":memory:"},y0="crypto",Ra="client_ed25519_seed",_0=Z.ONE_DAY,b0="keychain",v0="0.3",w0="messages",m0="0.3",E0=Z.SIX_HOURS,D0="publisher",La="irn",S0="error",Fa="wss://relay.walletconnect.com",x0="relayer",Ve={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},O0="_subscription",gi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},$a=Z.ONE_SECOND,I0="2.5.0",P0="0.3",Ot={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},A0="subscription",T0="0.3",C0=Z.FIVE_SECONDS*1e3,N0="pairing",R0="0.3",Br={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},It={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},L0="history",F0="0.3",$0="expirer",yt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},U0="0.3";class M0{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=b0,this.version=v0,this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,zo(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ko(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class j0{constructor(e,r,i){this.core=e,this.logger=r,this.name=y0,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=po(n);return fo(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=Kd();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),o=po(s),c=bn();return await Zf(c,n,_0,o)},this.generateSharedKey=(n,s,o)=>{this.isInitialized();const c=this.getPrivateKey(n),l=Vd(c,s);return this.setSymKey(l,o)},this.setSymKey=async(n,s)=>{this.isInitialized();const o=s||Gd(n);return await this.keychain.set(o,n),o},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,o)=>{this.isInitialized();const c=Uo(o),l=Pr(s);if(Mo(c)){const w=c.senderPublicKey,S=c.receiverPublicKey;n=await this.generateSharedKey(w,S)}const h=this.getSymKey(n),{type:f,senderPublicKey:_}=c;return Wd({type:f,symKey:h,message:l,senderPublicKey:_})},this.decode=async(n,s,o)=>{this.isInitialized();const c=Xd(s,o);if(Mo(c)){const f=c.receiverPublicKey,_=c.senderPublicKey;n=await this.generateSharedKey(f,_)}const l=this.getSymKey(n),h=Yd({symKey:l,encoded:s});return Ji(h)},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.keychain=i||new M0(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}getPayloadType(e){const r=vn(e);return Nr(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Ra)}catch{e=bn(),await this.keychain.set(Ra,e)}return f0(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class B0 extends Lh{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=w0,this.version=m0,this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=ui(n);let o=this.messages.get(i);return typeof o>"u"&&(o={}),typeof o[s]<"u"||(o[s]=n,this.messages.set(i,o),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),o=ui(n);return typeof s[o]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=r}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,zo(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ko(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class H0 extends Fh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new it.exports.EventEmitter,this.name=D0,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,n,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});try{const o=s?.ttl||E0,c=mn(s),l=s?.prompt||!1,h=s?.tag||0,f={topic:i,message:n,opts:{ttl:o,relay:c,prompt:l,tag:h}},_=ui(n);this.queue.set(_,f);try{await await wn(this.rpcPublish(i,n,o,c,l,h),this.publishTimeout),this.relayer.events.emit(Ve.publish,f)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Ve.connection_stalled);return}this.onPublish(_,f),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}})}catch(o){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(o),o}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,s,o){var c,l,h,f;const _={method:hi(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:s,tag:o}};return at((c=_.params)==null?void 0:c.prompt)&&((l=_.params)==null||delete l.prompt),at((h=_.params)==null?void 0:h.tag)&&((f=_.params)==null||delete f.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:_}),this.relayer.provider.request(_)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:n}=e;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(wr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class q0{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var z0=Object.defineProperty,K0=Object.defineProperties,V0=Object.getOwnPropertyDescriptors,Ua=Object.getOwnPropertySymbols,G0=Object.prototype.hasOwnProperty,k0=Object.prototype.propertyIsEnumerable,Ma=(t,e,r)=>e in t?z0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Hr=(t,e)=>{for(var r in e||(e={}))G0.call(e,r)&&Ma(t,r,e[r]);if(Ua)for(var r of Ua(e))k0.call(e,r)&&Ma(t,r,e[r]);return t},$n=(t,e)=>K0(t,V0(e));class W0 extends Mh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new q0,this.events=new it.exports.EventEmitter,this.name=A0,this.version=T0,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=$t,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=mn(n),o={topic:i,relay:s};this.pending.set(i,o);const c=await this.rpcSubscribe(i,s);return this.onSubscribe(c,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,s)=>{const o=new Z.Watch;o.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(c),o.stop(this.pendingSubscriptionWatchLabel),n(!0)),o.elapsed(this.pendingSubscriptionWatchLabel)>=C0&&(clearInterval(c),o.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pollingInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.clientId=""}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=mn(i);await this.rpcUnsubscribe(e,r,n);const s=$e("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:hi(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await wn(this.relayer.provider.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ve.connection_stalled)}return ui(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:hi(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await wn(this.relayer.provider.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ve.connection_stalled)}}rpcUnsubscribe(e,r,i){const n={method:hi(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.provider.request(n)}onSubscribe(e,r){this.setSubscription(e,$n(Hr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Hr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Hr({},r)),this.topicMap.set(r.topic,e),this.events.emit(Ot.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Ot.deleted,$n(Hr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ot.sync)}async reset(){if(!this.cached.length)return;const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}this.events.emit(Ot.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);this.onBatchSubscribe(r.map((i,n)=>$n(Hr({},e[n]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(wr.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ve.connect,async()=>{await this.onConnect()}),this.relayer.on(Ve.disconnect,()=>{this.onDisconnect()}),this.events.on(Ot.created,async e=>{const r=Ot.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Ot.deleted,async e=>{const r=Ot.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var Y0=Object.defineProperty,ja=Object.getOwnPropertySymbols,J0=Object.prototype.hasOwnProperty,X0=Object.prototype.propertyIsEnumerable,Ba=(t,e,r)=>e in t?Y0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Z0=(t,e)=>{for(var r in e||(e={}))J0.call(e,r)&&Ba(t,r,e[r]);if(ja)for(var r of ja(e))X0.call(e,r)&&Ba(t,r,e[r]);return t};class Q0 extends $h{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new it.exports.EventEmitter,this.name=x0,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):fr(Se.getDefaultLoggerOptions({level:e.logger||S0})),this.messages=new B0(this.logger,e.core),this.subscriber=new W0(this,this.logger),this.publisher=new H0(this,this.logger),this.relayUrl=e?.relayUrl||Fa,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){this.isInitialized();let i="";return await Promise.all([new Promise(n=>{this.subscriber.once(Ot.created,s=>{s.topic===e&&n()})}),new Promise(async n=>{i=await this.subscriber.subscribe(e,r),n()})]),i}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ve.transport_closed))}async transportOpen(e){if(!this.reconnecting){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Ot.resubscribed,()=>{r()})}),await Promise.race([new Promise(async r=>{await this.provider.connect(),this.removeListener(Ve.transport_closed,this.rejectTransportOpen),r()}),new Promise(r=>this.once(Ve.transport_closed,this.rejectTransportOpen))])])}catch(r){const i=r;if(!/socket hang up/i.test(i.message))throw r;this.logger.error(r),this.events.emit(Ve.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(await this.transportClose(),await new Promise(r=>setTimeout(r,$a)),await this.transportOpen(e))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new Mr(new Bg(lp({sdkVersion:I0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0})))}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),An(e)){if(!e.method.endsWith(O0))return;const r=e.params,{topic:i,message:n,publishedAt:s}=r.data,o={topic:i,message:n,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Z0({type:"event",event:r.id},o)),this.events.emit(r.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ve.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Pn(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(gi.payload,e=>this.onProviderPayload(e)),this.provider.on(gi.connect,()=>{this.events.emit(Ve.connect)}),this.provider.on(gi.disconnect,()=>{this.events.emit(Ve.disconnect),this.attemptToReconnect()}),this.provider.on(gi.error,e=>{this.logger.error(e),this.events.emit(Ve.error,e)}),this.events.on(Ve.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},Z.toMiliseconds($a))}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var e_=Object.defineProperty,Ha=Object.getOwnPropertySymbols,t_=Object.prototype.hasOwnProperty,r_=Object.prototype.propertyIsEnumerable,qa=(t,e,r)=>e in t?e_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,za=(t,e)=>{for(var r in e||(e={}))t_.call(e,r)&&qa(t,r,e[r]);if(Ha)for(var r of Ha(e))r_.call(e,r)&&qa(t,r,e[r]);return t};class yi extends Uh{constructor(e,r,i,n=$t,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=P0,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{Np(o)?this.map.set(o.id,o):Rp(o)?this.map.set(o.topic,o):this.getKey&&o!==null&&!at(o)&&this.map.set(this.getKey(o),o)}),this.cached=[],this.initialized=!0)},this.set=async(o,c)=>{this.isInitialized(),this.map.has(o)?await this.update(o,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:c}),this.map.set(o,c),await this.persist())},this.get=o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o)),this.getAll=o=>(this.isInitialized(),o?this.values.filter(c=>Object.keys(o).every(l=>Hg(c[l],o[l]))):this.values),this.update=async(o,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:c});const l=za(za({},this.getData(o)),c);this.map.set(o,l),await this.persist()},this.delete=async(o,c)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:c}),this.map.delete(o),await this.persist())},this.logger=Se.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class i_{constructor(e,r){this.core=e,this.logger=r,this.name=N0,this.version=R0,this.events=new it.exports,this.initialized=!1,this.storagePrefix=$t,this.ignoredPayloadTypes=[Yt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=bn(),n=await this.core.crypto.setSymKey(i),s=xt(Z.FIVE_MINUTES),o={protocol:La},c={topic:n,expiry:s,relay:o,active:!1},l=Ep({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:o});return await this.pairings.set(n,c),await this.core.relayer.subscribe(n),this.core.expirer.set(n,s),{topic:n,uri:l}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:s,relay:o}=wp(i.uri);if(this.pairings.keys.includes(n))throw new Error(`Pairing already exists: ${n}`);if(this.core.crypto.hasKeys(n))throw new Error(`Keychain already exists: ${n}`);const c=xt(Z.FIVE_MINUTES),l={topic:n,relay:o,expiry:c,active:!1};return await this.pairings.set(n,l),await this.core.crypto.setSymKey(s,n),await this.core.relayer.subscribe(n,{relay:o}),this.core.expirer.set(n,c),i.activatePairing&&await this.activate({topic:n}),l},this.activate=async({topic:i})=>{this.isInitialized();const n=xt(Z.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:o,resolve:c,reject:l}=Xt();this.events.once(Le("pairing_ping",s),({error:h})=>{h?l(h):c()}),await o()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",$e("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,s)=>{const o=fi(n,s),c=await this.core.crypto.encode(i,o),l=Br[n].req;return this.core.history.set(i,o),await this.core.relayer.publish(i,c,l),o.id},this.sendResult=async(i,n,s)=>{const o=Pn(i,s),c=await this.core.crypto.encode(n,o),l=await this.core.history.get(n,i),h=Br[l.request.method].res;await this.core.relayer.publish(n,c,h),await this.core.history.resolve(o)},this.sendError=async(i,n,s)=>{const o=di(i,s),c=await this.core.crypto.encode(n,o),l=await this.core.history.get(n,i),h=Br[l.request.method]?Br[l.request.method].res:Br.unregistered_method.res;await this.core.relayer.publish(n,c,h),await this.core.history.resolve(o)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,$e("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>Ft(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:s}=i,o=s.method;if(this.pairings.keys.includes(n))switch(o){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:s}=i,o=(await this.core.history.get(n,s.id)).request.method;if(this.pairings.keys.includes(n))switch(o){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(o)}},this.onPairingPingRequest=async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit("pairing_ping",{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}},this.onPairingPingResponse=(i,n)=>{const{id:s}=n;setTimeout(()=>{Ct(n)?this.events.emit(Le("pairing_ping",s),{}):wt(n)&&this.events.emit(Le("pairing_ping",s),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit("pairing_delete",{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:s,method:o}=n;try{if(this.registeredMethods.includes(o))return;const c=$e("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,i,c),this.logger.error(c)}catch(c){await this.sendError(s,i,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error($e("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!ft(i)){const{message:n}=V("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!Cp(i.uri)){const{message:n}=V("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!ft(i)){const{message:s}=V("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!ft(i)){const{message:s}=V("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!Ke(i,!1)){const{message:n}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(Ft(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=V("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.pairings=new yi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ve.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);An(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Tn(n)&&(await this.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.core.expirer.on(yt.expired,async e=>{const{topic:r}=Go(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class n_ extends Rh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new it.exports.EventEmitter,this.name=L0,this.version=F0,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const o={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s};this.records.set(o.id,o),this.events.emit(It.created,o)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=wt(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(It.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(It.deleted,s)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:fi(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(It.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(It.created,e=>{const r=It.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(It.updated,e=>{const r=It.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(It.deleted,e=>{const r=It.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class s_ extends jh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new it.exports.EventEmitter,this.name=$0,this.version=U0,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),o={target:s,expiry:n};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(yt.created,{target:s,expiration:o})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(yt.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return fp(e);if(typeof e=="number")return dp(e);const{message:r}=V("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(yt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Z.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(yt.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(wr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(yt.created,e=>{const r=yt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(yt.expired,e=>{const r=yt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(yt.deleted,e=>{const r=yt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var o_=Object.defineProperty,Ka=Object.getOwnPropertySymbols,a_=Object.prototype.hasOwnProperty,c_=Object.prototype.propertyIsEnumerable,Va=(t,e,r)=>e in t?o_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ga=(t,e)=>{for(var r in e||(e={}))a_.call(e,r)&&Va(t,r,e[r]);if(Ka)for(var r of Ka(e))c_.call(e,r)&&Va(t,r,e[r]);return t};class Un extends Nh{constructor(e){super(e),this.protocol=Na,this.version=d0,this.name=Fn,this.events=new it.exports.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Fa;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:fr(Se.getDefaultLoggerOptions({level:e?.logger||p0.logger}));this.logger=Se.generateChildLogger(r,this.name),this.heartbeat=new wr.HeartBeat,this.crypto=new j0(this,this.logger,e?.keychain),this.history=new n_(this,this.logger),this.expirer=new s_(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new hu(Ga(Ga({},g0),e?.storageOptions)),this.relayer=new Q0({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new i_(this,this.logger)}static async init(e){const r=new Un(e);return await r.initialize(),r}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const u_=Un,ka="wc",Wa=2,Ya="client",Mn=`${ka}@${Wa}:${Ya}:`,jn={name:Ya,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},h_="proposal",Ja="Proposal expired",l_="session",_i=Z.SEVEN_DAYS,f_="engine",qr={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1115}}},Bn={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},d_="request";var p_=Object.defineProperty,g_=Object.defineProperties,y_=Object.getOwnPropertyDescriptors,Xa=Object.getOwnPropertySymbols,__=Object.prototype.hasOwnProperty,b_=Object.prototype.propertyIsEnumerable,Za=(t,e,r)=>e in t?p_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_t=(t,e)=>{for(var r in e||(e={}))__.call(e,r)&&Za(t,r,e[r]);if(Xa)for(var r of Xa(e))b_.call(e,r)&&Za(t,r,e[r]);return t},Hn=(t,e)=>g_(t,y_(e));class v_ extends Hh{constructor(e){super(e),this.name=f_,this.events=new it.exports,this.initialized=!1,this.ignoredPayloadTypes=[Yt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(qr)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const i=Hn(_t({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:o,sessionProperties:c,relays:l}=i;let h=n,f,_=!1;if(h&&(_=this.client.core.pairing.pairings.get(h).active),!h||!_){const{topic:P,uri:y}=await this.client.core.pairing.create();h=P,f=y}const w=await this.client.core.crypto.generateKeyPair(),S=_t({requiredNamespaces:s,optionalNamespaces:o,relays:l??[{protocol:La}],proposer:{publicKey:w,metadata:this.client.metadata}},c&&{sessionProperties:c}),{reject:m,resolve:R,done:L}=Xt(Z.FIVE_MINUTES,Ja);if(this.events.once(Le("session_connect"),async({error:P,session:y})=>{if(P)m(P);else if(y){y.self.publicKey=w;const D=Hn(_t({},y),{requiredNamespaces:y.requiredNamespaces,optionalNamespaces:y.optionalNamespaces});await this.client.session.set(y.topic,D),await this.setExpiry(y.topic,y.expiry),h&&await this.client.core.pairing.updateMetadata({topic:h,metadata:y.peer.metadata}),R(D)}}),!h){const{message:P}=V("NO_MATCHING_KEY",`connect() pairing topic: ${h}`);throw new Error(P)}const H=await this.sendRequest(h,"wc_sessionPropose",S),x=xt(Z.FIVE_MINUTES);return await this.setProposal(H,_t({id:H,expiry:x},S)),{uri:f,approval:L}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:s,sessionProperties:o}=r,c=this.client.proposal.get(i);let{pairingTopic:l,proposer:h,requiredNamespaces:f,optionalNamespaces:_}=c;Fr(f)||(f=Op(s,"approve()"));const w=await this.client.core.crypto.generateKeyPair(),S=h.publicKey,m=await this.client.core.crypto.generateSharedKey(w,S);l&&i&&(await this.client.core.pairing.updateMetadata({topic:l,metadata:h.metadata}),await this.sendResult(i,l,{relay:{protocol:n??"irn"},responderPublicKey:w}),await this.client.proposal.delete(i,$e("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:l}));const R=_t({relay:{protocol:n??"irn"},namespaces:s,requiredNamespaces:f,optionalNamespaces:_,controller:{publicKey:w,metadata:this.client.metadata},expiry:xt(_i)},o&&{sessionProperties:o});await this.client.core.relayer.subscribe(m);const L=await this.sendRequest(m,"wc_sessionSettle",R),{done:H,resolve:x,reject:P}=Xt();this.events.once(Le("session_approve",L),({error:D})=>{D?P(D):x(this.client.session.get(m))});const y=Hn(_t({},R),{topic:m,acknowledged:!1,self:R.controller,peer:{publicKey:h.publicKey,metadata:h.metadata},controller:w});return await this.client.session.set(m,y),await this.setExpiry(m,xt(_i)),{topic:m,acknowledged:H}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:s}=this.client.proposal.get(i);s&&(await this.sendError(i,s,n),await this.client.proposal.delete(i,$e("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,s=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:o,resolve:c,reject:l}=Xt();return this.events.once(Le("session_update",s),({error:h})=>{h?l(h):c()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:o}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:s,resolve:o,reject:c}=Xt();return this.events.once(Le("session_extend",n),({error:l})=>{l?c(l):o()}),await this.setExpiry(i,xt(_i)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:s,expiry:o}=r,c=await this.sendRequest(s,"wc_sessionRequest",{request:n,chainId:i},o),{done:l,resolve:h,reject:f}=Xt(o);return this.events.once(Le("session_request",c),({error:_,result:w})=>{_?f(_):h(w)}),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i}),await l()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n;Ct(n)?await this.sendResult(s,i,n.result):wt(n)&&await this.sendError(s,i,n.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:s,resolve:o,reject:c}=Xt();this.events.once(Le("session_ping",n),({error:l})=>{l?c(l):o()}),await s()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",$e("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>Ap(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,$e("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.deleteSymKey(r),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,$e("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=qr.wc_sessionRequest.req.ttl,{id:n,topic:s,params:o}=r;await this.client.pendingRequest.set(n,{id:n,topic:s,params:o}),i&&this.client.core.expirer.set(n,xt(i))},this.sendRequest=async(r,i,n,s)=>{const o=fi(i,n),c=await this.client.core.crypto.encode(r,o),l=qr[i].req;return s&&(l.ttl=s),this.client.core.history.set(r,o),this.client.core.relayer.publish(r,c,l),o.id},this.sendResult=async(r,i,n)=>{const s=Pn(r,n),o=await this.client.core.crypto.encode(i,s),c=await this.client.core.history.get(i,r),l=qr[c.request.method].res;this.client.core.relayer.publish(i,o,l),await this.client.core.history.resolve(s)},this.sendError=async(r,i,n)=>{const s=di(r,n),o=await this.client.core.crypto.encode(i,s),c=await this.client.core.history.get(i,r),l=qr[c.request.method].res;this.client.core.relayer.publish(i,o,l),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{Ft(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{Ft(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,s=n.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,s=(await this.client.core.history.get(i,n.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidConnect(_t({},i.params));const o=xt(Z.FIVE_MINUTES),c=_t({id:s,pairingTopic:r,expiry:o},n);await this.setProposal(s,c),this.client.events.emit("session_proposal",{id:s,params:c})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(Ct(i)){const{result:s}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const o=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});const c=o.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const h=await this.client.core.crypto.generateSharedKey(c,l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:h});const f=await this.client.core.relayer.subscribe(h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:f}),await this.client.core.pairing.activate({topic:r})}else wt(i)&&(await this.client.proposal.delete(n,$e("USER_DISCONNECTED")),this.events.emit(Le("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:c,expiry:l,namespaces:h,requiredNamespaces:f,optionalNamespaces:_,sessionProperties:w}=i.params,S=_t({topic:r,relay:o,expiry:l,namespaces:h,acknowledged:!0,requiredNamespaces:f,optionalNamespaces:_,controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},w&&{sessionProperties:w});await this.sendResult(i.id,r,!0),this.events.emit(Le("session_connect"),{session:S})}catch(o){await this.sendError(n,r,o),this.client.logger.error(o)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;Ct(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Le("session_approve",n),{})):wt(i)&&(await this.client.session.delete(r,$e("USER_DISCONNECTED")),this.events.emit(Le("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidUpdate(_t({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(Le("session_update",n),{}):wt(i)&&this.events.emit(Le("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,xt(_i)),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(Le("session_extend",n),{}):wt(i)&&this.events.emit(Le("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{Ct(i)?this.events.emit(Le("session_ping",n),{}):wt(i)&&this.events.emit(Le("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),this.client.core.relayer.once(Ve.publish,async()=>{await this.deleteSession(r)}),await this.sendResult(n,r,!0),this.client.events.emit("session_delete",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidRequest(_t({topic:r},s)),await this.setPendingSessionRequest({id:n,topic:r,params:s}),this.client.events.emit("session_request",{id:n,topic:r,params:s})}catch(o){await this.sendError(n,r,o),this.client.logger.error(o)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(Le("session_request",n),{result:i.result}):wt(i)&&this.events.emit(Le("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidEmit(_t({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s})}catch(o){await this.sendError(n,r,o),this.client.logger.error(o)}},this.isValidConnect=async r=>{if(!ft(r)){const{message:l}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(l)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:o,relays:c}=r;if(at(i)||await this.isValidPairingTopic(i),!Hp(c,!0)){const{message:l}=V("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}!at(n)&&Fr(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!at(s)&&Fr(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),at(o)||this.validateSessionProps(o,"sessionProperties")},this.validateNamespaces=(r,i)=>{const n=Bp(r,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async r=>{if(!ft(r))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:o}=r;await this.isValidProposalId(i);const c=this.client.proposal.get(i),l=li(n,"approve()");if(l)throw new Error(l.message);const h=Qo(c.requiredNamespaces,n,"approve()");if(h)throw new Error(h.message);if(!Ke(s,!0)){const{message:f}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(f)}at(o)||this.validateSessionProps(o,"sessionProperties")},this.isValidReject=async r=>{if(!ft(r)){const{message:s}=V("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!zp(n)){const{message:s}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!ft(r)){const{message:h}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(h)}const{relay:i,controller:n,namespaces:s,expiry:o}=r;if(!Xo(i)){const{message:h}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(h)}const c=Lp(n,"onSessionSettleRequest()");if(c)throw new Error(c.message);const l=li(s,"onSessionSettleRequest()");if(l)throw new Error(l.message);if(Ft(o)){const{message:h}=V("EXPIRED","onSessionSettleRequest()");throw new Error(h)}},this.isValidUpdate=async r=>{if(!ft(r)){const{message:l}=V("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(l)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const s=this.client.session.get(i),o=li(n,"update()");if(o)throw new Error(o.message);const c=Qo(s.requiredNamespaces,n,"update()");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!ft(r)){const{message:n}=V("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!ft(r)){const{message:l}=V("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(l)}const{topic:i,request:n,chainId:s,expiry:o}=r;await this.isValidSessionTopic(i);const{namespaces:c}=this.client.session.get(i);if(!Zo(c,s)){const{message:l}=V("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(l)}if(!Kp(n)){const{message:l}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(l)}if(!kp(c,s,n.method)){const{message:l}=V("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(l)}if(o&&!Xp(o,Bn)){const{message:l}=V("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Bn.min} and ${Bn.max}`);throw new Error(l)}},this.isValidRespond=async r=>{if(!ft(r)){const{message:s}=V("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!Vp(n)){const{message:s}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!ft(r)){const{message:n}=V("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!ft(r)){const{message:c}=V("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:o}=this.client.session.get(i);if(!Zo(o,s)){const{message:c}=V("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(c)}if(!Gp(n)){const{message:c}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}if(!Wp(o,s,n.name)){const{message:c}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!ft(r)){const{message:n}=V("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(n=>{if(!Ke(n,!1)){const{message:s}=V("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Ve.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);An(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Tn(n)&&(await this.client.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.client.core.expirer.on(yt.expired,async e=>{const{topic:r,id:i}=Go(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,V("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!Ke(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Ft(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=V("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Ke(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Ft(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=V("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Ke(e,!1)){const{message:r}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!qp(e)){const{message:r}=V("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Ft(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=V("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class w_ extends yi{constructor(e,r){super(e,r,h_,Mn),this.core=e,this.logger=r}}class m_ extends yi{constructor(e,r){super(e,r,l_,Mn),this.core=e,this.logger=r}}class E_ extends yi{constructor(e,r){super(e,r,d_,Mn),this.core=e,this.logger=r}}class qn extends Bh{constructor(e){super(e),this.protocol=ka,this.version=Wa,this.name=jn.name,this.events=new it.exports.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||jn.name,this.metadata=e?.metadata||ap();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:fr(Se.getDefaultLoggerOptions({level:e?.logger||jn.logger}));this.core=e?.core||new u_(e),this.logger=Se.generateChildLogger(r,this.name),this.session=new m_(this.core,this.logger),this.proposal=new w_(this.core,this.logger),this.pendingRequest=new E_(this.core,this.logger),this.engine=new v_(this)}static async init(e){const r=new qn(e);return await r.initialize(),r}get context(){return Se.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var zn={exports:{}};(function(t,e){var r=typeof self<"u"?self:ze,i=function(){function s(){this.fetch=!1,this.DOMException=r.DOMException}return s.prototype=r,new s}();(function(s){(function(o){var c={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function l(g){return g&&DataView.prototype.isPrototypeOf(g)}if(c.arrayBuffer)var h=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(g){return g&&h.indexOf(Object.prototype.toString.call(g))>-1};function _(g){if(typeof g!="string"&&(g=String(g)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(g))throw new TypeError("Invalid character in header field name");return g.toLowerCase()}function w(g){return typeof g!="string"&&(g=String(g)),g}function S(g){var b={next:function(){var $=g.shift();return{done:$===void 0,value:$}}};return c.iterable&&(b[Symbol.iterator]=function(){return b}),b}function m(g){this.map={},g instanceof m?g.forEach(function(b,$){this.append($,b)},this):Array.isArray(g)?g.forEach(function(b){this.append(b[0],b[1])},this):g&&Object.getOwnPropertyNames(g).forEach(function(b){this.append(b,g[b])},this)}m.prototype.append=function(g,b){g=_(g),b=w(b);var $=this.map[g];this.map[g]=$?$+", "+b:b},m.prototype.delete=function(g){delete this.map[_(g)]},m.prototype.get=function(g){return g=_(g),this.has(g)?this.map[g]:null},m.prototype.has=function(g){return this.map.hasOwnProperty(_(g))},m.prototype.set=function(g,b){this.map[_(g)]=w(b)},m.prototype.forEach=function(g,b){for(var $ in this.map)this.map.hasOwnProperty($)&&g.call(b,this.map[$],$,this)},m.prototype.keys=function(){var g=[];return this.forEach(function(b,$){g.push($)}),S(g)},m.prototype.values=function(){var g=[];return this.forEach(function(b){g.push(b)}),S(g)},m.prototype.entries=function(){var g=[];return this.forEach(function(b,$){g.push([$,b])}),S(g)},c.iterable&&(m.prototype[Symbol.iterator]=m.prototype.entries);function R(g){if(g.bodyUsed)return Promise.reject(new TypeError("Already read"));g.bodyUsed=!0}function L(g){return new Promise(function(b,$){g.onload=function(){b(g.result)},g.onerror=function(){$(g.error)}})}function H(g){var b=new FileReader,$=L(b);return b.readAsArrayBuffer(g),$}function x(g){var b=new FileReader,$=L(b);return b.readAsText(g),$}function P(g){for(var b=new Uint8Array(g),$=new Array(b.length),U=0;U<b.length;U++)$[U]=String.fromCharCode(b[U]);return $.join("")}function y(g){if(g.slice)return g.slice(0);var b=new Uint8Array(g.byteLength);return b.set(new Uint8Array(g)),b.buffer}function D(){return this.bodyUsed=!1,this._initBody=function(g){this._bodyInit=g,g?typeof g=="string"?this._bodyText=g:c.blob&&Blob.prototype.isPrototypeOf(g)?this._bodyBlob=g:c.formData&&FormData.prototype.isPrototypeOf(g)?this._bodyFormData=g:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(g)?this._bodyText=g.toString():c.arrayBuffer&&c.blob&&l(g)?(this._bodyArrayBuffer=y(g.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(g)||f(g))?this._bodyArrayBuffer=y(g):this._bodyText=g=Object.prototype.toString.call(g):this._bodyText="",this.headers.get("content-type")||(typeof g=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(g)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var g=R(this);if(g)return g;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?R(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(H)}),this.text=function(){var g=R(this);if(g)return g;if(this._bodyBlob)return x(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(P(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(M)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function a(g){var b=g.toUpperCase();return E.indexOf(b)>-1?b:g}function d(g,b){b=b||{};var $=b.body;if(g instanceof d){if(g.bodyUsed)throw new TypeError("Already read");this.url=g.url,this.credentials=g.credentials,b.headers||(this.headers=new m(g.headers)),this.method=g.method,this.mode=g.mode,this.signal=g.signal,!$&&g._bodyInit!=null&&($=g._bodyInit,g.bodyUsed=!0)}else this.url=String(g);if(this.credentials=b.credentials||this.credentials||"same-origin",(b.headers||!this.headers)&&(this.headers=new m(b.headers)),this.method=a(b.method||this.method||"GET"),this.mode=b.mode||this.mode||null,this.signal=b.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&$)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody($)}d.prototype.clone=function(){return new d(this,{body:this._bodyInit})};function M(g){var b=new FormData;return g.trim().split("&").forEach(function($){if($){var U=$.split("="),N=U.shift().replace(/\+/g," "),C=U.join("=").replace(/\+/g," ");b.append(decodeURIComponent(N),decodeURIComponent(C))}}),b}function q(g){var b=new m,$=g.replace(/\r?\n[\t ]+/g," ");return $.split(/\r?\n/).forEach(function(U){var N=U.split(":"),C=N.shift().trim();if(C){var j=N.join(":").trim();b.append(C,j)}}),b}D.call(d.prototype);function G(g,b){b||(b={}),this.type="default",this.status=b.status===void 0?200:b.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in b?b.statusText:"OK",this.headers=new m(b.headers),this.url=b.url||"",this._initBody(g)}D.call(G.prototype),G.prototype.clone=function(){return new G(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},G.error=function(){var g=new G(null,{status:0,statusText:""});return g.type="error",g};var J=[301,302,303,307,308];G.redirect=function(g,b){if(J.indexOf(b)===-1)throw new RangeError("Invalid status code");return new G(null,{status:b,headers:{location:g}})},o.DOMException=s.DOMException;try{new o.DOMException}catch{o.DOMException=function(b,$){this.message=b,this.name=$;var U=Error(b);this.stack=U.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function X(g,b){return new Promise(function($,U){var N=new d(g,b);if(N.signal&&N.signal.aborted)return U(new o.DOMException("Aborted","AbortError"));var C=new XMLHttpRequest;function j(){C.abort()}C.onload=function(){var B={status:C.status,statusText:C.statusText,headers:q(C.getAllResponseHeaders()||"")};B.url="responseURL"in C?C.responseURL:B.headers.get("X-Request-URL");var Q="response"in C?C.response:C.responseText;$(new G(Q,B))},C.onerror=function(){U(new TypeError("Network request failed"))},C.ontimeout=function(){U(new TypeError("Network request failed"))},C.onabort=function(){U(new o.DOMException("Aborted","AbortError"))},C.open(N.method,N.url,!0),N.credentials==="include"?C.withCredentials=!0:N.credentials==="omit"&&(C.withCredentials=!1),"responseType"in C&&c.blob&&(C.responseType="blob"),N.headers.forEach(function(B,Q){C.setRequestHeader(Q,B)}),N.signal&&(N.signal.addEventListener("abort",j),C.onreadystatechange=function(){C.readyState===4&&N.signal.removeEventListener("abort",j)}),C.send(typeof N._bodyInit>"u"?null:N._bodyInit)})}return X.polyfill=!0,s.fetch||(s.fetch=X,s.Headers=m,s.Request=d,s.Response=G),o.Headers=m,o.Request=d,o.Response=G,o.fetch=X,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var n=i;e=n.fetch,e.default=n.fetch,e.fetch=n.fetch,e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response,t.exports=e})(zn,zn.exports);var Qa=yc(zn.exports);const ec={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},tc=10;class bi{constructor(e){if(this.url=e,this.events=new it.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!ha(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const i=Pr(e),s=await(await Qa(this.url,Object.assign(Object.assign({},ec),{body:i}))).json();this.onPayload({data:s})}catch(i){this.onError(e.id,i)}}async register(e=this.url){if(!ha(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return n(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{const r=Pr({id:1,jsonrpc:"2.0",method:"test",params:[]});await Qa(e,Object.assign(Object.assign({},ec),{body:r})),this.onOpen()}catch(r){const i=this.parseError(r);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Ji(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=di(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return na(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>tc&&this.events.setMaxListeners(tc)}}const rc="error",D_="wss://relay.walletconnect.com",S_="wc",x_="universal_provider",ic=`${S_}@${2}:${x_}:`,O_="https://rpc.walletconnect.com/v1",zr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function hr(t,e,r){let i;const n=Kn(t);return e.rpcMap&&(i=e.rpcMap[n]),i||(i=`${O_}?chainId=eip155:${n}&projectId=${r}`),i}function Kn(t){return t.includes("eip155")?Number(t.split(":")[1]):Number(t)}function I_(t,e){if(!e.includes(t))throw new Error(`Chain '${t}' not approved. Please use one of the following: ${e.toString()}`)}function P_(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}const vi=(t,e)=>{const r=i=>{i.request!==e.request||i.topic!==e.topic||(t.events.removeListener("session_request_sent",r),A_())};t.on("session_request_sent",r)};function A_(){if(typeof window<"u")try{const t=window.localStorage.getItem("WALLETCONNECT_DEEPLINK_CHOICE");if(t){const e=JSON.parse(t);window.open(e.href,"_self","noreferrer noopener")}}catch(t){console.error(t)}}class T_{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){var r;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?(vi(this.client,e),await this.client.request(e)):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){const i=Kn(e);if(!this.httpProviders[i]){const n=r||hr(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.chainId=i,this.events.emit(zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const i=r||hr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Mr(new bi(i))}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const i=Kn(r);e[i]=this.createHttpProvider(i)}),e}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}handleSwitchChain(e){const r=parseInt(e,16),i=`${this.name}:${r}`;I_(i,this.namespace.chains),this.setDefaultChain(`${r}`)}}class C_{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(vi(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const i=r||hr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||hr(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Mr(new bi(i))}}class N_{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(vi(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||hr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||hr(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Mr(new bi(i))}}class R_{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(vi(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||this.getCardanoRPCUrl(e);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(zr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const i=this.getCardanoRPCUrl(r);e[r]=this.createHttpProvider(r,i)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||this.getCardanoRPCUrl(e);return typeof i>"u"?void 0:new Mr(new bi(i))}}var L_=Object.defineProperty,F_=Object.defineProperties,$_=Object.getOwnPropertyDescriptors,nc=Object.getOwnPropertySymbols,U_=Object.prototype.hasOwnProperty,M_=Object.prototype.propertyIsEnumerable,sc=(t,e,r)=>e in t?L_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,wi=(t,e)=>{for(var r in e||(e={}))U_.call(e,r)&&sc(t,r,e[r]);if(nc)for(var r of nc(e))M_.call(e,r)&&sc(t,r,e[r]);return t},Vn=(t,e)=>F_(t,$_(e));class mi{constructor(e){this.events=new it.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:fr(Se.getDefaultLoggerOptions({level:e?.logger||rc}))}static async init(e){const r=new mi(e);return await r.initialize(),r}async request(e,r){const[i,n]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:wi({},e),chainId:`${i}:${n}`,topic:this.session.topic})}sendAsync(e,r,i){this.request(e,i).then(n=>r(null,n)).catch(n=>r(n,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:$e("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:i,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),await n().then(s=>{this.session=s}).catch(s=>{if(s.message!==Ja)throw s;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,r){try{const[i,n]=this.validateChain(e);this.getProvider(i).setDefaultChain(n,r)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Lr(r)){for(const i of r)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await qn.init({logger:this.providerOpts.logger||rc,relayUrl:this.providerOpts.relayUrl||D_,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach(e=>{var r,i,n;const s=((r=this.session)==null?void 0:r.namespaces[e].accounts)||[],o=P_(s),c=Vn(wi({},Object.assign(this.namespaces[e],(n=(i=this.optionalNamespaces)==null?void 0:i[e])!=null?n:{})),{accounts:s,chains:o});switch(e){case"eip155":this.rpcProviders[e]=new T_({client:this.client,namespace:c,events:this.events});break;case"solana":this.rpcProviders[e]=new C_({client:this.client,namespace:c,events:this.events});break;case"cosmos":this.rpcProviders[e]=new N_({client:this.client,namespace:c,events:this.events});break;case"polkadot":break;case"cip34":this.rpcProviders[e]=new R_({client:this.client,namespace:c,events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:i}=r;i.name==="accountsChanged"?this.events.emit("accountsChanged",i.data):i.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var i;const{namespaces:n}=r,s=(i=this.client)==null?void 0:i.session.get(e);this.session=Vn(wi({},s),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Vn(wi({},$e("USER_DISCONNECTED")),{data:e.topic}))}),this.on(zr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:i,sessionProperties:n}=e;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=i,this.sessionProperties=n,this.persist("namespaces",r),this.persist("optionalNamespaces",i)}validateChain(e){const[r,i]=e?.split(":")||["",""];if(r&&!Object.keys(this.namespaces).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&i)return[r,i];const n=Object.keys(this.namespaces)[0],s=this.rpcProviders[n].getDefaultChain();return[n,s]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r=!1){const[i,n]=this.validateChain(e);r||this.getProvider(i).setDefaultChain(n),this.namespaces[i].defaultChain=n,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",n)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(e,r){this.client.core.storage.setItem(`${ic}/${e}`,r)}async getFromStore(e){return await this.client.core.storage.getItem(`${ic}/${e}`)}}const j_=mi;Ht.UniversalProvider=j_,Ht.default=mi,Object.defineProperty(Ht,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
